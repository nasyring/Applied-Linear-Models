<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Randomization and Permutation Testing | Applied Linear Models</title>
  <meta name="description" content="These are a collection of notes related to STAT 500 at Iowa State University. This is a work in progress." />
  <meta name="generator" content="bookdown 0.29 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Randomization and Permutation Testing | Applied Linear Models" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="These are a collection of notes related to STAT 500 at Iowa State University. This is a work in progress." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Randomization and Permutation Testing | Applied Linear Models" />
  
  <meta name="twitter:description" content="These are a collection of notes related to STAT 500 at Iowa State University. This is a work in progress." />
  

<meta name="author" content="Nick Syring" />


<meta name="date" content="2022-12-08" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="introduction-to-linear-models.html"/>
<link rel="next" href="alternatives-for-non-normal-responses.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Applied Linear Models</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> About</a></li>
<li class="chapter" data-level="2" data-path="data-analysis-and-statistical-inference.html"><a href="data-analysis-and-statistical-inference.html"><i class="fa fa-check"></i><b>2</b> Data Analysis and Statistical Inference</a>
<ul>
<li class="chapter" data-level="2.1" data-path="data-analysis-and-statistical-inference.html"><a href="data-analysis-and-statistical-inference.html#data-experiments-and-studies"><i class="fa fa-check"></i><b>2.1</b> Data, Experiments, and Studies</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="data-analysis-and-statistical-inference.html"><a href="data-analysis-and-statistical-inference.html#james-linds-scurvy-trial"><i class="fa fa-check"></i><b>2.1.1</b> James Lind’s Scurvy Trial</a></li>
<li class="chapter" data-level="2.1.2" data-path="data-analysis-and-statistical-inference.html"><a href="data-analysis-and-statistical-inference.html#framingham-heart-study"><i class="fa fa-check"></i><b>2.1.2</b> Framingham Heart Study</a></li>
<li class="chapter" data-level="2.1.3" data-path="data-analysis-and-statistical-inference.html"><a href="data-analysis-and-statistical-inference.html#harris-bank-sex-pay-study"><i class="fa fa-check"></i><b>2.1.3</b> Harris Bank Sex Pay Study</a></li>
<li class="chapter" data-level="2.1.4" data-path="data-analysis-and-statistical-inference.html"><a href="data-analysis-and-statistical-inference.html#large-aggregated-data-sets"><i class="fa fa-check"></i><b>2.1.4</b> Large, Aggregated Data Sets</a></li>
<li class="chapter" data-level="2.1.5" data-path="data-analysis-and-statistical-inference.html"><a href="data-analysis-and-statistical-inference.html#study-concepts"><i class="fa fa-check"></i><b>2.1.5</b> Study Concepts</a></li>
<li class="chapter" data-level="2.1.6" data-path="data-analysis-and-statistical-inference.html"><a href="data-analysis-and-statistical-inference.html#randomization-control-and-causation"><i class="fa fa-check"></i><b>2.1.6</b> Randomization, control, and causation</a></li>
<li class="chapter" data-level="2.1.7" data-path="data-analysis-and-statistical-inference.html"><a href="data-analysis-and-statistical-inference.html#populations-and-scope-of-inference"><i class="fa fa-check"></i><b>2.1.7</b> Populations and scope of inference</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="data-analysis-and-statistical-inference.html"><a href="data-analysis-and-statistical-inference.html#data-summaries"><i class="fa fa-check"></i><b>2.2</b> Data Summaries</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="data-analysis-and-statistical-inference.html"><a href="data-analysis-and-statistical-inference.html#numerical-summaries"><i class="fa fa-check"></i><b>2.2.1</b> Numerical Summaries</a></li>
<li class="chapter" data-level="2.2.2" data-path="data-analysis-and-statistical-inference.html"><a href="data-analysis-and-statistical-inference.html#visual-summaries"><i class="fa fa-check"></i><b>2.2.2</b> Visual Summaries</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="data-analysis-and-statistical-inference.html"><a href="data-analysis-and-statistical-inference.html#statistical-inference"><i class="fa fa-check"></i><b>2.3</b> Statistical Inference</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="introduction-to-linear-models.html"><a href="introduction-to-linear-models.html"><i class="fa fa-check"></i><b>3</b> Introduction to Linear Models</a>
<ul>
<li class="chapter" data-level="3.1" data-path="introduction-to-linear-models.html"><a href="introduction-to-linear-models.html#defining-the-linear-model"><i class="fa fa-check"></i><b>3.1</b> Defining the linear model</a></li>
<li class="chapter" data-level="3.2" data-path="introduction-to-linear-models.html"><a href="introduction-to-linear-models.html#gauss-markov-model-for-one-sample"><i class="fa fa-check"></i><b>3.2</b> Gauss-Markov model for one sample</a></li>
<li class="chapter" data-level="3.3" data-path="introduction-to-linear-models.html"><a href="introduction-to-linear-models.html#gauss-markov-model-for-comparing-two-samples"><i class="fa fa-check"></i><b>3.3</b> Gauss-Markov model for comparing two samples</a></li>
<li class="chapter" data-level="3.4" data-path="introduction-to-linear-models.html"><a href="introduction-to-linear-models.html#pairwise-testing-and-bonferroni-correction"><i class="fa fa-check"></i><b>3.4</b> Pairwise testing and Bonferroni correction</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="introduction-to-linear-models.html"><a href="introduction-to-linear-models.html#example-co2-uptake-in-echinochloa-crus-galli"><i class="fa fa-check"></i><b>3.4.1</b> Example: Co2 uptake in Echinochloa crus-galli</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="introduction-to-linear-models.html"><a href="introduction-to-linear-models.html#linear-models-for-more-than-two-treatments-populations"><i class="fa fa-check"></i><b>3.5</b> Linear Models for more than two treatments (populations)</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="randomization-and-permutation-testing.html"><a href="randomization-and-permutation-testing.html"><i class="fa fa-check"></i><b>4</b> Randomization and Permutation Testing</a>
<ul>
<li class="chapter" data-level="4.1" data-path="randomization-and-permutation-testing.html"><a href="randomization-and-permutation-testing.html#setup"><i class="fa fa-check"></i><b>4.1</b> Setup</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="randomization-and-permutation-testing.html"><a href="randomization-and-permutation-testing.html#example-1-the-harris-bank-sex-pay-study"><i class="fa fa-check"></i><b>4.1.1</b> Example 1: The Harris Bank Sex Pay Study</a></li>
<li class="chapter" data-level="4.1.2" data-path="randomization-and-permutation-testing.html"><a href="randomization-and-permutation-testing.html#difference-in-mean-salaries-between-genders"><i class="fa fa-check"></i><b>4.1.2</b> Difference in mean salaries between genders</a></li>
<li class="chapter" data-level="4.1.3" data-path="randomization-and-permutation-testing.html"><a href="randomization-and-permutation-testing.html#randomization-test-for-treatment-significance"><i class="fa fa-check"></i><b>4.1.3</b> Randomization test for treatment significance</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="alternatives-for-non-normal-responses.html"><a href="alternatives-for-non-normal-responses.html"><i class="fa fa-check"></i><b>5</b> Alternatives for Non-Normal Responses</a>
<ul>
<li class="chapter" data-level="5.1" data-path="alternatives-for-non-normal-responses.html"><a href="alternatives-for-non-normal-responses.html#transformations"><i class="fa fa-check"></i><b>5.1</b> Transformations</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="alternatives-for-non-normal-responses.html"><a href="alternatives-for-non-normal-responses.html#example-cloud-seeding-for-rainfall"><i class="fa fa-check"></i><b>5.1.1</b> Example: Cloud Seeding for Rainfall</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="alternatives-for-non-normal-responses.html"><a href="alternatives-for-non-normal-responses.html#rank-sum-test"><i class="fa fa-check"></i><b>5.2</b> Rank-Sum Test</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="alternatives-for-non-normal-responses.html"><a href="alternatives-for-non-normal-responses.html#example-ratio-measurements"><i class="fa fa-check"></i><b>5.2.1</b> Example: ratio measurements</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="alternatives-for-non-normal-responses.html"><a href="alternatives-for-non-normal-responses.html#signed-rank-test"><i class="fa fa-check"></i><b>5.3</b> Signed-rank test</a></li>
<li class="chapter" data-level="5.4" data-path="alternatives-for-non-normal-responses.html"><a href="alternatives-for-non-normal-responses.html#bootstrap"><i class="fa fa-check"></i><b>5.4</b> Bootstrap</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="alternatives-for-non-normal-responses.html"><a href="alternatives-for-non-normal-responses.html#intro-to-the-bootstrap"><i class="fa fa-check"></i><b>5.4.1</b> Intro to the bootstrap</a></li>
<li class="chapter" data-level="5.4.2" data-path="alternatives-for-non-normal-responses.html"><a href="alternatives-for-non-normal-responses.html#bootstrap-confidence-intervals"><i class="fa fa-check"></i><b>5.4.2</b> Bootstrap Confidence Intervals</a></li>
<li class="chapter" data-level="5.4.3" data-path="alternatives-for-non-normal-responses.html"><a href="alternatives-for-non-normal-responses.html#bootstrapping-linear-models"><i class="fa fa-check"></i><b>5.4.3</b> Bootstrapping linear models</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="one-way-anova.html"><a href="one-way-anova.html"><i class="fa fa-check"></i><b>6</b> One Way ANOVA</a>
<ul>
<li class="chapter" data-level="6.1" data-path="one-way-anova.html"><a href="one-way-anova.html#the-gauss-markov-model-for-comparing-i-populations"><i class="fa fa-check"></i><b>6.1</b> The Gauss-Markov Model for comparing I populations</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="one-way-anova.html"><a href="one-way-anova.html#example-donuts-effects-model"><i class="fa fa-check"></i><b>6.1.1</b> Example: Donuts effects model</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="one-way-anova.html"><a href="one-way-anova.html#testing-equality-of-means"><i class="fa fa-check"></i><b>6.2</b> Testing equality of means</a></li>
<li class="chapter" data-level="6.3" data-path="one-way-anova.html"><a href="one-way-anova.html#follow-up-testing"><i class="fa fa-check"></i><b>6.3</b> Follow-up testing</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="one-way-anova.html"><a href="one-way-anova.html#donuts-example"><i class="fa fa-check"></i><b>6.3.1</b> Donuts example</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="one-way-anova.html"><a href="one-way-anova.html#inference-for-particular-contrasts"><i class="fa fa-check"></i><b>6.4</b> Inference for particular contrasts</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="one-way-anova.html"><a href="one-way-anova.html#donuts-example-1"><i class="fa fa-check"></i><b>6.4.1</b> Donuts Example</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="one-way-anova.html"><a href="one-way-anova.html#checking-assumptions-in-one-way-anova"><i class="fa fa-check"></i><b>6.5</b> Checking Assumptions in one-way ANOVA</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="one-way-anova.html"><a href="one-way-anova.html#example-cehcking-assumptions-for-donuts-experiment"><i class="fa fa-check"></i><b>6.5.1</b> Example: Cehcking assumptions for donuts experiment</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="randomized-complete-block-design.html"><a href="randomized-complete-block-design.html"><i class="fa fa-check"></i><b>7</b> Randomized Complete Block Design</a>
<ul>
<li class="chapter" data-level="7.1" data-path="randomized-complete-block-design.html"><a href="randomized-complete-block-design.html#paired-experiments-as-blocking"><i class="fa fa-check"></i><b>7.1</b> Paired experiments as blocking</a></li>
<li class="chapter" data-level="7.2" data-path="randomized-complete-block-design.html"><a href="randomized-complete-block-design.html#randomized-complete-block-designs"><i class="fa fa-check"></i><b>7.2</b> Randomized Complete Block Designs</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="randomized-complete-block-design.html"><a href="randomized-complete-block-design.html#notation"><i class="fa fa-check"></i><b>7.2.1</b> Notation</a></li>
<li class="chapter" data-level="7.2.2" data-path="randomized-complete-block-design.html"><a href="randomized-complete-block-design.html#example-penicillin-manufacturing"><i class="fa fa-check"></i><b>7.2.2</b> Example: Penicillin Manufacturing</a></li>
<li class="chapter" data-level="7.2.3" data-path="randomized-complete-block-design.html"><a href="randomized-complete-block-design.html#sums-of-squares-and-f-tests-in-rcbd"><i class="fa fa-check"></i><b>7.2.3</b> Sums of squares and F tests in RCBD</a></li>
<li class="chapter" data-level="7.2.4" data-path="randomized-complete-block-design.html"><a href="randomized-complete-block-design.html#example-significance-of-process-in-penicillin-experiment"><i class="fa fa-check"></i><b>7.2.4</b> Example: Significance of Process in Penicillin experiment</a></li>
<li class="chapter" data-level="7.2.5" data-path="randomized-complete-block-design.html"><a href="randomized-complete-block-design.html#follow-up-comparisons-and-contrasts"><i class="fa fa-check"></i><b>7.2.5</b> Follow-up comparisons and contrasts</a></li>
<li class="chapter" data-level="7.2.6" data-path="randomized-complete-block-design.html"><a href="randomized-complete-block-design.html#example-tukey-contrasts-and-scheffe-for-penicillin-experiment"><i class="fa fa-check"></i><b>7.2.6</b> Example: Tukey, contrasts, and Scheffe for penicillin experiment</a></li>
<li class="chapter" data-level="7.2.7" data-path="randomized-complete-block-design.html"><a href="randomized-complete-block-design.html#relative-efficiency-of-blocking-vs.-crd"><i class="fa fa-check"></i><b>7.2.7</b> Relative efficiency of Blocking (vs. CRD)</a></li>
<li class="chapter" data-level="7.2.8" data-path="randomized-complete-block-design.html"><a href="randomized-complete-block-design.html#example-re-of-blocking-in-penicillin-experiment"><i class="fa fa-check"></i><b>7.2.8</b> Example: RE of blocking in penicillin experiment</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="latin-squares-for-two-blocking-variables.html"><a href="latin-squares-for-two-blocking-variables.html"><i class="fa fa-check"></i><b>8</b> Latin Squares for two blocking variables</a>
<ul>
<li class="chapter" data-level="8.1" data-path="latin-squares-for-two-blocking-variables.html"><a href="latin-squares-for-two-blocking-variables.html#designs-for-multiple-blocks"><i class="fa fa-check"></i><b>8.1</b> Designs for multiple blocks</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="latin-squares-for-two-blocking-variables.html"><a href="latin-squares-for-two-blocking-variables.html#example-mpg-experiment"><i class="fa fa-check"></i><b>8.1.1</b> Example: MPG experiment</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="latin-squares-for-two-blocking-variables.html"><a href="latin-squares-for-two-blocking-variables.html#model-notation"><i class="fa fa-check"></i><b>8.2</b> Model notation</a></li>
<li class="chapter" data-level="8.3" data-path="latin-squares-for-two-blocking-variables.html"><a href="latin-squares-for-two-blocking-variables.html#sums-of-squares-and-test-for-treatment-effects"><i class="fa fa-check"></i><b>8.3</b> Sums of squares and test for treatment effects</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="latin-squares-for-two-blocking-variables.html"><a href="latin-squares-for-two-blocking-variables.html#example-mpg-experiment-1"><i class="fa fa-check"></i><b>8.3.1</b> Example: MPG experiment</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="latin-squares-for-two-blocking-variables.html"><a href="latin-squares-for-two-blocking-variables.html#relative-efficiency-of-blocking"><i class="fa fa-check"></i><b>8.4</b> Relative efficiency of blocking</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="latin-squares-for-two-blocking-variables.html"><a href="latin-squares-for-two-blocking-variables.html#example-re-ignoring-driver-blocks"><i class="fa fa-check"></i><b>8.4.1</b> Example: RE ignoring driver blocks</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="two-way-anova.html"><a href="two-way-anova.html"><i class="fa fa-check"></i><b>9</b> Two-Way ANOVA</a>
<ul>
<li class="chapter" data-level="9.1" data-path="two-way-anova.html"><a href="two-way-anova.html#the-model"><i class="fa fa-check"></i><b>9.1</b> The Model</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="two-way-anova.html"><a href="two-way-anova.html#example-protein-chemistry"><i class="fa fa-check"></i><b>9.1.1</b> Example: protein chemistry</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="two-way-anova.html"><a href="two-way-anova.html#tests-for-interaction-and-main-effects"><i class="fa fa-check"></i><b>9.2</b> Tests for interaction and main effects</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="two-way-anova.html"><a href="two-way-anova.html#example-protein-and-dietary-metals"><i class="fa fa-check"></i><b>9.2.1</b> Example: Protein and dietary metals</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="unbalanced-data-in-two-way-anova.html"><a href="unbalanced-data-in-two-way-anova.html"><i class="fa fa-check"></i><b>10</b> Unbalanced data in Two-Way ANOVA</a>
<ul>
<li class="chapter" data-level="10.1" data-path="unbalanced-data-in-two-way-anova.html"><a href="unbalanced-data-in-two-way-anova.html#raw-and-least-squares-means"><i class="fa fa-check"></i><b>10.1</b> Raw and Least-Squares Means</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="unbalanced-data-in-two-way-anova.html"><a href="unbalanced-data-in-two-way-anova.html#example-turbine-data"><i class="fa fa-check"></i><b>10.1.1</b> Example: Turbine data</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="unbalanced-data-in-two-way-anova.html"><a href="unbalanced-data-in-two-way-anova.html#partial-f-tests-and-type-iii-ss"><i class="fa fa-check"></i><b>10.2</b> Partial F tests and Type III SS</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="unbalanced-data-in-two-way-anova.html"><a href="unbalanced-data-in-two-way-anova.html#example-turbine-data-tests"><i class="fa fa-check"></i><b>10.2.1</b> Example: Turbine Data tests</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="unbalanced-data-in-two-way-anova.html"><a href="unbalanced-data-in-two-way-anova.html#follow-up-tests"><i class="fa fa-check"></i><b>10.3</b> Follow-up tests</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="unbalanced-data-in-two-way-anova.html"><a href="unbalanced-data-in-two-way-anova.html#example-turbine-data-tukey-corrected-pairwise-comparisons"><i class="fa fa-check"></i><b>10.3.1</b> Example: Turbine data Tukey-corrected pairwise comparisons</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="unbalanced-data-in-two-way-anova.html"><a href="unbalanced-data-in-two-way-anova.html#unbalanced-data-and-simpsons-paradox"><i class="fa fa-check"></i><b>10.4</b> Unbalanced data and Simpson’s Paradox</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="missing-cells-in-two-way-anova.html"><a href="missing-cells-in-two-way-anova.html"><i class="fa fa-check"></i><b>11</b> Missing Cells in Two-Way ANOVA</a>
<ul>
<li class="chapter" data-level="11.1" data-path="missing-cells-in-two-way-anova.html"><a href="missing-cells-in-two-way-anova.html#anova-with-missing-at-random-cell"><i class="fa fa-check"></i><b>11.1</b> ANOVA with missing “at random” cell</a></li>
<li class="chapter" data-level="11.2" data-path="missing-cells-in-two-way-anova.html"><a href="missing-cells-in-two-way-anova.html#do-any-of-the-treatments-matter"><i class="fa fa-check"></i><b>11.2</b> Do any of the treatments matter?</a></li>
<li class="chapter" data-level="11.3" data-path="missing-cells-in-two-way-anova.html"><a href="missing-cells-in-two-way-anova.html#fit-a-linear-model-with-additional-constraints"><i class="fa fa-check"></i><b>11.3</b> Fit a linear model with additional constraints</a></li>
<li class="chapter" data-level="11.4" data-path="missing-cells-in-two-way-anova.html"><a href="missing-cells-in-two-way-anova.html#general-linear-test-for-interaction"><i class="fa fa-check"></i><b>11.4</b> General Linear Test for interaction</a></li>
<li class="chapter" data-level="11.5" data-path="missing-cells-in-two-way-anova.html"><a href="missing-cells-in-two-way-anova.html#partial-analysis-for-interaction"><i class="fa fa-check"></i><b>11.5</b> Partial analysis for interaction</a></li>
<li class="chapter" data-level="11.6" data-path="missing-cells-in-two-way-anova.html"><a href="missing-cells-in-two-way-anova.html#tests-for-main-effects-in-the-partial-table"><i class="fa fa-check"></i><b>11.6</b> Tests for main effects in the partial table</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="strategy-for-analysis-in-two-factor-models.html"><a href="strategy-for-analysis-in-two-factor-models.html"><i class="fa fa-check"></i><b>12</b> Strategy for Analysis in Two-Factor models</a>
<ul>
<li class="chapter" data-level="12.1" data-path="strategy-for-analysis-in-two-factor-models.html"><a href="strategy-for-analysis-in-two-factor-models.html#unbalanced-two-factor-experiment-chick-weight"><i class="fa fa-check"></i><b>12.1</b> Unbalanced Two-Factor Experiment: Chick Weight</a></li>
<li class="chapter" data-level="12.2" data-path="strategy-for-analysis-in-two-factor-models.html"><a href="strategy-for-analysis-in-two-factor-models.html#example-observational-study-on-growth-hormone-deficient-children-with-empty-cell"><i class="fa fa-check"></i><b>12.2</b> Example: observational study on growth-hormone deficient children with empty cell</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="strategy-for-analysis-in-two-factor-models.html"><a href="strategy-for-analysis-in-two-factor-models.html#linear-model-analysis-with-extra-constraint"><i class="fa fa-check"></i><b>12.2.1</b> Linear Model analysis with extra constraint</a></li>
<li class="chapter" data-level="12.2.2" data-path="strategy-for-analysis-in-two-factor-models.html"><a href="strategy-for-analysis-in-two-factor-models.html#partial-table-analysis"><i class="fa fa-check"></i><b>12.2.2</b> Partial Table analysis</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="k-factorial-experiments.html"><a href="k-factorial-experiments.html"><i class="fa fa-check"></i><b>13</b> <span class="math inline">\(2^k\)</span> Factorial Experiments</a>
<ul>
<li class="chapter" data-level="13.1" data-path="k-factorial-experiments.html"><a href="k-factorial-experiments.html#the-model-1"><i class="fa fa-check"></i><b>13.1</b> The Model</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="k-factorial-experiments.html"><a href="k-factorial-experiments.html#example-stress-test-study"><i class="fa fa-check"></i><b>13.1.1</b> Example: Stress Test Study</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="k-factorial-experiments.html"><a href="k-factorial-experiments.html#unreplicated-factorial-experiments"><i class="fa fa-check"></i><b>13.2</b> Unreplicated Factorial Experiments</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="k-factorial-experiments.html"><a href="k-factorial-experiments.html#example-granola-bar-experiment"><i class="fa fa-check"></i><b>13.2.1</b> Example: Granola bar experiment</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="linear-regression.html"><a href="linear-regression.html"><i class="fa fa-check"></i><b>14</b> Linear Regression</a>
<ul>
<li class="chapter" data-level="14.1" data-path="linear-regression.html"><a href="linear-regression.html#diamonds-dataset"><i class="fa fa-check"></i><b>14.1</b> Diamonds dataset</a></li>
<li class="chapter" data-level="14.2" data-path="linear-regression.html"><a href="linear-regression.html#checking-linearity"><i class="fa fa-check"></i><b>14.2</b> Checking Linearity</a></li>
<li class="chapter" data-level="14.3" data-path="linear-regression.html"><a href="linear-regression.html#multicollinearity"><i class="fa fa-check"></i><b>14.3</b> Multicollinearity</a></li>
<li class="chapter" data-level="14.4" data-path="linear-regression.html"><a href="linear-regression.html#model-with-carat-interactions"><i class="fa fa-check"></i><b>14.4</b> Model with carat interactions</a></li>
<li class="chapter" data-level="14.5" data-path="linear-regression.html"><a href="linear-regression.html#interpreting-the-model"><i class="fa fa-check"></i><b>14.5</b> Interpreting the model</a></li>
<li class="chapter" data-level="14.6" data-path="linear-regression.html"><a href="linear-regression.html#checking-constant-variance"><i class="fa fa-check"></i><b>14.6</b> Checking Constant Variance</a></li>
<li class="chapter" data-level="14.7" data-path="linear-regression.html"><a href="linear-regression.html#normality"><i class="fa fa-check"></i><b>14.7</b> Normality</a></li>
<li class="chapter" data-level="14.8" data-path="linear-regression.html"><a href="linear-regression.html#addressing-non-constant-variance-using-wls"><i class="fa fa-check"></i><b>14.8</b> Addressing non-constant variance using WLS</a></li>
<li class="chapter" data-level="14.9" data-path="linear-regression.html"><a href="linear-regression.html#inferences-using-wls"><i class="fa fa-check"></i><b>14.9</b> Inferences using WLS</a></li>
<li class="chapter" data-level="14.10" data-path="linear-regression.html"><a href="linear-regression.html#using-built-in-functions-in-r-for-inference"><i class="fa fa-check"></i><b>14.10</b> Using built-in functions in R for inference</a></li>
<li class="chapter" data-level="14.11" data-path="linear-regression.html"><a href="linear-regression.html#leverage-outliers-and-influence"><i class="fa fa-check"></i><b>14.11</b> Leverage, outliers, and influence</a>
<ul>
<li class="chapter" data-level="14.11.1" data-path="linear-regression.html"><a href="linear-regression.html#illustrations"><i class="fa fa-check"></i><b>14.11.1</b> Illustrations</a></li>
</ul></li>
<li class="chapter" data-level="14.12" data-path="linear-regression.html"><a href="linear-regression.html#numerical-summaries-of-outliers-leverage-and-influence"><i class="fa fa-check"></i><b>14.12</b> Numerical summaries of outliers, leverage, and influence</a></li>
<li class="chapter" data-level="14.13" data-path="linear-regression.html"><a href="linear-regression.html#leverage-diamonds-model"><i class="fa fa-check"></i><b>14.13</b> Leverage, Diamonds model</a>
<ul>
<li class="chapter" data-level="14.13.1" data-path="linear-regression.html"><a href="linear-regression.html#outliers-diamonds-model"><i class="fa fa-check"></i><b>14.13.1</b> Outliers, diamonds model</a></li>
<li class="chapter" data-level="14.13.2" data-path="linear-regression.html"><a href="linear-regression.html#plotting-outliers-with-leverage"><i class="fa fa-check"></i><b>14.13.2</b> plotting outliers with leverage</a></li>
<li class="chapter" data-level="14.13.3" data-path="linear-regression.html"><a href="linear-regression.html#cooks-distance-df-betas-df-fits"><i class="fa fa-check"></i><b>14.13.3</b> Cook’s distance, DF betas, DF fits</a></li>
<li class="chapter" data-level="14.13.4" data-path="linear-regression.html"><a href="linear-regression.html#model-fit-without-high-leverage-outliers"><i class="fa fa-check"></i><b>14.13.4</b> Model fit without high leverage outliers</a></li>
</ul></li>
<li class="chapter" data-level="14.14" data-path="linear-regression.html"><a href="linear-regression.html#dealing-with-highly-influential-data-points"><i class="fa fa-check"></i><b>14.14</b> Dealing with highly influential data points</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="analysis-of-covariance.html"><a href="analysis-of-covariance.html"><i class="fa fa-check"></i><b>15</b> Analysis of Covariance</a>
<ul>
<li class="chapter" data-level="15.1" data-path="analysis-of-covariance.html"><a href="analysis-of-covariance.html#choice-of-concommitant-variable"><i class="fa fa-check"></i><b>15.1</b> Choice of “concommitant” variable</a></li>
<li class="chapter" data-level="15.2" data-path="analysis-of-covariance.html"><a href="analysis-of-covariance.html#interaction-and-regression-slopes"><i class="fa fa-check"></i><b>15.2</b> Interaction and regression slopes</a></li>
<li class="chapter" data-level="15.3" data-path="analysis-of-covariance.html"><a href="analysis-of-covariance.html#inference-questions"><i class="fa fa-check"></i><b>15.3</b> Inference questions</a></li>
<li class="chapter" data-level="15.4" data-path="analysis-of-covariance.html"><a href="analysis-of-covariance.html#example"><i class="fa fa-check"></i><b>15.4</b> Example</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="gauss-markov-theory.html"><a href="gauss-markov-theory.html"><i class="fa fa-check"></i><b>16</b> Gauss-Markov Theory</a>
<ul>
<li class="chapter" data-level="16.1" data-path="gauss-markov-theory.html"><a href="gauss-markov-theory.html#estimability"><i class="fa fa-check"></i><b>16.1</b> Estimability</a>
<ul>
<li class="chapter" data-level="16.1.1" data-path="gauss-markov-theory.html"><a href="gauss-markov-theory.html#characterizing-estimable-functions-in-one-way-anova"><i class="fa fa-check"></i><b>16.1.1</b> Characterizing estimable functions in one-way ANOVA</a></li>
<li class="chapter" data-level="16.1.2" data-path="gauss-markov-theory.html"><a href="gauss-markov-theory.html#characterizing-estimable-functions-in-rcbd-using-the-null-space-of-x"><i class="fa fa-check"></i><b>16.1.2</b> Characterizing estimable functions in RCBD using the null space of <span class="math inline">\(X\)</span></a></li>
<li class="chapter" data-level="16.1.3" data-path="gauss-markov-theory.html"><a href="gauss-markov-theory.html#characterizing-estimable-functions-in-rcbd-by-solving-an-inhomogeneous-equation"><i class="fa fa-check"></i><b>16.1.3</b> Characterizing estimable functions in RCBD by solving an inhomogeneous equation</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="gauss-markov-theory.html"><a href="gauss-markov-theory.html#estimation"><i class="fa fa-check"></i><b>16.2</b> Estimation</a>
<ul>
<li class="chapter" data-level="16.2.1" data-path="gauss-markov-theory.html"><a href="gauss-markov-theory.html#full-rank-estimation"><i class="fa fa-check"></i><b>16.2.1</b> Full rank estimation</a></li>
<li class="chapter" data-level="16.2.2" data-path="gauss-markov-theory.html"><a href="gauss-markov-theory.html#less-than-full-rank-estimation"><i class="fa fa-check"></i><b>16.2.2</b> Less than full rank estimation</a></li>
<li class="chapter" data-level="16.2.3" data-path="gauss-markov-theory.html"><a href="gauss-markov-theory.html#augmented-normal-equations"><i class="fa fa-check"></i><b>16.2.3</b> Augmented normal equations</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Applied Linear Models</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="randomization-and-permutation-testing" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">Chapter 4</span> Randomization and Permutation Testing<a href="randomization-and-permutation-testing.html#randomization-and-permutation-testing" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="setup" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Setup<a href="randomization-and-permutation-testing.html#setup" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Randomization/permutation testing is performed in the context of randomized intervention experiments or observational studies to examine the differences in response between two groups. The setting is similar to the setting in which the two-sample t-test is often used, but there are few other similarities.<br />
<br><br>
A general algorithm for a randomization test of two groups, labelled, say, 0 and 1, is as follows:
1. Choose some statistic, say <span class="math inline">\(T\)</span>, quantifying the response difference between the groups and compute this <span class="math inline">\(T = t_0\)</span> for the observed data.<br>
For m in 1:M repeat:<br>
2. Permute the 0,1 labels of the responses. If the data comes from a randomized experiment this is like saying the randomization of subjects to treatments turned out differently, hence the name randomization test. <br>
3. Compute the <span class="math inline">\(m^{th}\)</span> statistic value <span class="math inline">\(t_m\)</span> on the responses with permuted/re-randomized labels.<br><br></p>
<p>At the end of this algorithm we end up with the values <span class="math inline">\(t_1, \ldots, t_m\)</span>. What do we make of these? Here’s the idea. For a concrete example, suppose <span class="math inline">\(T\)</span> is the Student’s <span class="math inline">\(t\)</span> two-sample test statistic, i.e., <span class="math inline">\(T = \frac{\overline x_0 - \overline x_1}{\sqrt{S_0^2/n_0 + S_1^2/n_1}}\)</span>. Let <span class="math inline">\(x\)</span> denote all the responses of both groups pooled together, i.e., <span class="math inline">\(x = (x_{0,1}, ..., x_{0,n_0}, x_{1,1}, ...,x_{1,n_1})\)</span>. <span class="math inline">\(x\)</span> has some sample mean value; call it <span class="math inline">\(\overline x\)</span>. If we randomly label <span class="math inline">\(n_0\)</span> of the x’s 0 and the other <span class="math inline">\(n_1\)</span> of them 1, we should expect the average value of <span class="math inline">\(\overline x_0 - \overline x_1\)</span> to be about 0 when averaging over repeated re-labeling. That’s because <span class="math inline">\(\overline x_0\)</span> and <span class="math inline">\(\overline x_1\)</span> are both approximately unbiased for <span class="math inline">\(\overline x\)</span>. So the distribution/histogram of the <span class="math inline">\(t_1, ..., t_m\)</span> values will look roughly symmetric around zero. Then, we compare the observed value <span class="math inline">\(t_0\)</span> to this distribution and observe whether <span class="math inline">\(t_0\)</span> is a “typical” value or and “extreme” value compared to <span class="math inline">\(t_1, ..., t_m\)</span>; that is, we compare <span class="math inline">\(t_0\)</span> the the quantiles of <span class="math inline">\(t_1, ..., t_m\)</span>. If <span class="math inline">\(t_0\)</span> is extreme compared to these values, then either we observed such a value by a small chance or the labels really do have an effect on the responses which is reflected in the statistic <span class="math inline">\(T\)</span>. <br><br></p>
<p>This description should sound very similar to null hypothesis testing and rejection rules defined by comparing a test statistic to a null distribution. But,there are some differences. In this case, the “population” consists only of the observed values. And, the <em>randomization distribution</em>—the histogram/quantiles of <span class="math inline">\(t_1, ..., t_m\)</span>—is only related to the observed data, not any larger population. This means that the “null hypothesis” that a randomization test tests is related only to the observed data. I think of the null and alternative hypotheses as the following: <span class="math inline">\(H_0: \text{the observed value } t_0 \text{ is consistent with labels being randomly assigned to responses}\)</span> versus <span class="math inline">\(H_a: \text{the observed value } t_0 \text{ is NOT consistent with labels being randomly assigned to responses}\)</span>. Because the test references no population, the conclusion is only pertinent to the sampled subjects. If the original labels were assigned by randomization (i.e., they represent an intervention) then the conclusion may claim causation.</p>
<div id="example-1-the-harris-bank-sex-pay-study" class="section level3 hasAnchor" number="4.1.1">
<h3><span class="header-section-number">4.1.1</span> Example 1: The Harris Bank Sex Pay Study<a href="randomization-and-permutation-testing.html#example-1-the-harris-bank-sex-pay-study" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We have worked with this data before: there are 93 salaries of Harris Bank employees from 1969-1971. The workers are all entry-level clerical workers. We’re interested in whether males and females are paid differently.</p>
<a href="data:text/csv;base64,U2FsYXJ5LFNleA0KNDYyMCwxDQo1MDQwLDENCjUxMDAsMQ0KNTEwMCwxDQo1MjIwLDENCjU0MDAsMQ0KNTQwMCwxDQo1NDAwLDENCjU0MDAsMQ0KNTQwMCwxDQo1NzAwLDENCjYwMDAsMQ0KNjAwMCwxDQo2MDAwLDENCjYwMDAsMQ0KNjAwMCwxDQo2MDAwLDENCjYwMDAsMQ0KNjAwMCwxDQo2MDAwLDENCjYwMDAsMQ0KNjAwMCwxDQo2MDAwLDENCjYwMDAsMQ0KNjMwMCwxDQo2NjAwLDENCjY2MDAsMQ0KNjYwMCwxDQo2ODQwLDENCjY5MDAsMQ0KNjkwMCwxDQo4MTAwLDENCjM5MDAsMA0KNDAyMCwwDQo0MjkwLDANCjQzODAsMA0KNDM4MCwwDQo0MzgwLDANCjQzODAsMA0KNDM4MCwwDQo0NDQwLDANCjQ1MDAsMA0KNDUwMCwwDQo0NjIwLDANCjQ4MDAsMA0KNDgwMCwwDQo0ODAwLDANCjQ4MDAsMA0KNDgwMCwwDQo0ODAwLDANCjQ4MDAsMA0KNDgwMCwwDQo0ODAwLDANCjQ4MDAsMA0KNDk4MCwwDQo1MTAwLDANCjUxMDAsMA0KNTEwMCwwDQo1MTAwLDANCjUxMDAsMA0KNTEwMCwwDQo1MTYwLDANCjUyMjAsMA0KNTIyMCwwDQo1MjgwLDANCjUyODAsMA0KNTI4MCwwDQo1NDAwLDANCjU0MDAsMA0KNTQwMCwwDQo1NDAwLDANCjU0MDAsMA0KNTQwMCwwDQo1NDAwLDANCjU0MDAsMA0KNTQwMCwwDQo1NDAwLDANCjU0MDAsMA0KNTQwMCwwDQo1NTIwLDANCjU1MjAsMA0KNTU4MCwwDQo1NjQwLDANCjU3MDAsMA0KNTcwMCwwDQo1NzAwLDANCjU3MDAsMA0KNTcwMCwwDQo2MDAwLDANCjYwMDAsMA0KNjEyMCwwDQo2MzAwLDANCjYzMDAsMA0K" download="salaries.csv">Download salaries.csv</a>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="randomization-and-permutation-testing.html#cb55-1" aria-hidden="true" tabindex="-1"></a>salaries.df <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&#39;salaries.csv&#39;</span>)</span>
<span id="cb55-2"><a href="randomization-and-permutation-testing.html#cb55-2" aria-hidden="true" tabindex="-1"></a>salaries.df</span></code></pre></div>
<pre><code>##    Salary Sex
## 1    4620   1
## 2    5040   1
## 3    5100   1
## 4    5100   1
## 5    5220   1
## 6    5400   1
## 7    5400   1
## 8    5400   1
## 9    5400   1
## 10   5400   1
## 11   5700   1
## 12   6000   1
## 13   6000   1
## 14   6000   1
## 15   6000   1
## 16   6000   1
## 17   6000   1
## 18   6000   1
## 19   6000   1
## 20   6000   1
## 21   6000   1
## 22   6000   1
## 23   6000   1
## 24   6000   1
## 25   6300   1
## 26   6600   1
## 27   6600   1
## 28   6600   1
## 29   6840   1
## 30   6900   1
## 31   6900   1
## 32   8100   1
## 33   3900   0
## 34   4020   0
## 35   4290   0
## 36   4380   0
## 37   4380   0
## 38   4380   0
## 39   4380   0
## 40   4380   0
## 41   4440   0
## 42   4500   0
## 43   4500   0
## 44   4620   0
## 45   4800   0
## 46   4800   0
## 47   4800   0
## 48   4800   0
## 49   4800   0
## 50   4800   0
## 51   4800   0
## 52   4800   0
## 53   4800   0
## 54   4800   0
## 55   4980   0
## 56   5100   0
## 57   5100   0
## 58   5100   0
## 59   5100   0
## 60   5100   0
## 61   5100   0
## 62   5160   0
## 63   5220   0
## 64   5220   0
## 65   5280   0
## 66   5280   0
## 67   5280   0
## 68   5400   0
## 69   5400   0
## 70   5400   0
## 71   5400   0
## 72   5400   0
## 73   5400   0
## 74   5400   0
## 75   5400   0
## 76   5400   0
## 77   5400   0
## 78   5400   0
## 79   5400   0
## 80   5520   0
## 81   5520   0
## 82   5580   0
## 83   5640   0
## 84   5700   0
## 85   5700   0
## 86   5700   0
## 87   5700   0
## 88   5700   0
## 89   6000   0
## 90   6000   0
## 91   6120   0
## 92   6300   0
## 93   6300   0</code></pre>
</div>
<div id="difference-in-mean-salaries-between-genders" class="section level3 hasAnchor" number="4.1.2">
<h3><span class="header-section-number">4.1.2</span> Difference in mean salaries between genders<a href="randomization-and-permutation-testing.html#difference-in-mean-salaries-between-genders" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="randomization-and-permutation-testing.html#cb57-1" aria-hidden="true" tabindex="-1"></a>n0 <span class="ot">&lt;-</span> <span class="fu">sum</span>(salaries.df<span class="sc">$</span>Sex<span class="sc">==</span><span class="dv">0</span>)</span>
<span id="cb57-2"><a href="randomization-and-permutation-testing.html#cb57-2" aria-hidden="true" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> <span class="fu">sum</span>(salaries.df<span class="sc">$</span>Sex<span class="sc">==</span><span class="dv">1</span>)</span>
<span id="cb57-3"><a href="randomization-and-permutation-testing.html#cb57-3" aria-hidden="true" tabindex="-1"></a>m0 <span class="ot">&lt;-</span> <span class="fu">mean</span>(salaries.df<span class="sc">$</span>Salary[salaries.df<span class="sc">$</span>Sex<span class="sc">==</span><span class="dv">0</span>])</span>
<span id="cb57-4"><a href="randomization-and-permutation-testing.html#cb57-4" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(salaries.df<span class="sc">$</span>Salary[salaries.df<span class="sc">$</span>Sex<span class="sc">==</span><span class="dv">1</span>])</span>
<span id="cb57-5"><a href="randomization-and-permutation-testing.html#cb57-5" aria-hidden="true" tabindex="-1"></a>s0 <span class="ot">&lt;-</span> <span class="fu">var</span>(salaries.df<span class="sc">$</span>Salary[salaries.df<span class="sc">$</span>Sex<span class="sc">==</span><span class="dv">0</span>])</span>
<span id="cb57-6"><a href="randomization-and-permutation-testing.html#cb57-6" aria-hidden="true" tabindex="-1"></a>s1 <span class="ot">&lt;-</span> <span class="fu">var</span>(salaries.df<span class="sc">$</span>Salary[salaries.df<span class="sc">$</span>Sex<span class="sc">==</span><span class="dv">1</span>])</span>
<span id="cb57-7"><a href="randomization-and-permutation-testing.html#cb57-7" aria-hidden="true" tabindex="-1"></a>t0 <span class="ot">&lt;-</span> (m0 <span class="sc">-</span> m1)<span class="sc">/</span><span class="fu">sqrt</span>(s0<span class="sc">/</span>n0<span class="sc">+</span>s1<span class="sc">/</span>n1)</span>
<span id="cb57-8"><a href="randomization-and-permutation-testing.html#cb57-8" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(t0,m0,m1,<span class="fu">sqrt</span>(s0),<span class="fu">sqrt</span>(s1))</span></code></pre></div>
<pre><code>## [1]   -5.829974 5138.852459 5956.875000  539.870658  690.733306</code></pre>
</div>
<div id="randomization-test-for-treatment-significance" class="section level3 hasAnchor" number="4.1.3">
<h3><span class="header-section-number">4.1.3</span> Randomization test for treatment significance<a href="randomization-and-permutation-testing.html#randomization-test-for-treatment-significance" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Algorithm:
for 1000 loops do:
1. randomly shuffle the sex labels over salaries
2. compute the two-sample t-test stat for the reshuffled labels
return all 1000 differences</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="randomization-and-permutation-testing.html#cb59-1" aria-hidden="true" tabindex="-1"></a>n0 <span class="ot">&lt;-</span> <span class="fu">sum</span>(salaries.df<span class="sc">$</span>Sex<span class="sc">==</span><span class="dv">0</span>)</span>
<span id="cb59-2"><a href="randomization-and-permutation-testing.html#cb59-2" aria-hidden="true" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> <span class="fu">sum</span>(salaries.df<span class="sc">$</span>Sex<span class="sc">==</span><span class="dv">1</span>)</span>
<span id="cb59-3"><a href="randomization-and-permutation-testing.html#cb59-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> n0<span class="sc">+</span>n1</span>
<span id="cb59-4"><a href="randomization-and-permutation-testing.html#cb59-4" aria-hidden="true" tabindex="-1"></a>randomization.test <span class="ot">&lt;-</span> <span class="cf">function</span>(M){</span>
<span id="cb59-5"><a href="randomization-and-permutation-testing.html#cb59-5" aria-hidden="true" tabindex="-1"></a>  ts <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>,M)</span>
<span id="cb59-6"><a href="randomization-and-permutation-testing.html#cb59-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(m <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>M){</span>
<span id="cb59-7"><a href="randomization-and-permutation-testing.html#cb59-7" aria-hidden="true" tabindex="-1"></a>    permute.n <span class="ot">&lt;-</span> <span class="fu">sample.int</span>(n,n,<span class="at">replace =</span> F)</span>
<span id="cb59-8"><a href="randomization-and-permutation-testing.html#cb59-8" aria-hidden="true" tabindex="-1"></a>    re.randomized.group <span class="ot">&lt;-</span> salaries.df<span class="sc">$</span>Sex[permute.n]</span>
<span id="cb59-9"><a href="randomization-and-permutation-testing.html#cb59-9" aria-hidden="true" tabindex="-1"></a>    m0 <span class="ot">&lt;-</span> <span class="fu">mean</span>(salaries.df<span class="sc">$</span>Salary[re.randomized.group<span class="sc">==</span><span class="dv">0</span>])</span>
<span id="cb59-10"><a href="randomization-and-permutation-testing.html#cb59-10" aria-hidden="true" tabindex="-1"></a>    m1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(salaries.df<span class="sc">$</span>Salary[re.randomized.group<span class="sc">==</span><span class="dv">1</span>])</span>
<span id="cb59-11"><a href="randomization-and-permutation-testing.html#cb59-11" aria-hidden="true" tabindex="-1"></a>    s0 <span class="ot">&lt;-</span> <span class="fu">var</span>(salaries.df<span class="sc">$</span>Salary[re.randomized.group<span class="sc">==</span><span class="dv">0</span>])</span>
<span id="cb59-12"><a href="randomization-and-permutation-testing.html#cb59-12" aria-hidden="true" tabindex="-1"></a>    s1 <span class="ot">&lt;-</span> <span class="fu">var</span>(salaries.df<span class="sc">$</span>Salary[re.randomized.group<span class="sc">==</span><span class="dv">1</span>])</span>
<span id="cb59-13"><a href="randomization-and-permutation-testing.html#cb59-13" aria-hidden="true" tabindex="-1"></a>    ts[m] <span class="ot">&lt;-</span> (m0 <span class="sc">-</span> m1)<span class="sc">/</span><span class="fu">sqrt</span>(s0<span class="sc">/</span>n0<span class="sc">+</span>s1<span class="sc">/</span>n1)</span>
<span id="cb59-14"><a href="randomization-and-permutation-testing.html#cb59-14" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb59-15"><a href="randomization-and-permutation-testing.html#cb59-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(ts)</span>
<span id="cb59-16"><a href="randomization-and-permutation-testing.html#cb59-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb59-17"><a href="randomization-and-permutation-testing.html#cb59-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-18"><a href="randomization-and-permutation-testing.html#cb59-18" aria-hidden="true" tabindex="-1"></a>ts <span class="ot">&lt;-</span> <span class="fu">randomization.test</span>(<span class="dv">1000</span>)</span>
<span id="cb59-19"><a href="randomization-and-permutation-testing.html#cb59-19" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(ts)</span>
<span id="cb59-20"><a href="randomization-and-permutation-testing.html#cb59-20" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">quantile</span>(ts, <span class="fl">0.975</span>), <span class="at">col =</span> <span class="st">&#39;blue&#39;</span>)</span>
<span id="cb59-21"><a href="randomization-and-permutation-testing.html#cb59-21" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">quantile</span>(ts, <span class="fl">0.025</span>), <span class="at">col =</span> <span class="st">&#39;blue&#39;</span>)</span></code></pre></div>
<p><img src="03-RandomizationTests_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p>The <span class="math inline">\(t_0\)</span> value of <span class="math inline">\(-5.83\)</span> is off the chart (literally). How do we interpret this? The test randomly labels observed sexes with observed salaries. The observed test statistic suggests this is not how the salaries were actually assigned to workers. That’s pretty obvious—companies do not tend to assign salaries in a random fashion. But, if the salary assignment was not random with respect to sex, then it either depended on sex or depends on a hidden variable closely associated with sex. Since the job, time frame, and experience level were controlled for, it is certainly plausible that the salary assignment depended on sex.</p>
<p><br><br></p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="randomization-and-permutation-testing.html#cb60-1" aria-hidden="true" tabindex="-1"></a>n0 <span class="ot">&lt;-</span> <span class="fu">sum</span>(salaries.df<span class="sc">$</span>Sex<span class="sc">==</span><span class="dv">0</span>)</span>
<span id="cb60-2"><a href="randomization-and-permutation-testing.html#cb60-2" aria-hidden="true" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> <span class="fu">sum</span>(salaries.df<span class="sc">$</span>Sex<span class="sc">==</span><span class="dv">1</span>)</span>
<span id="cb60-3"><a href="randomization-and-permutation-testing.html#cb60-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> n0<span class="sc">+</span>n1</span>
<span id="cb60-4"><a href="randomization-and-permutation-testing.html#cb60-4" aria-hidden="true" tabindex="-1"></a>randomization.test <span class="ot">&lt;-</span> <span class="cf">function</span>(M, df){</span>
<span id="cb60-5"><a href="randomization-and-permutation-testing.html#cb60-5" aria-hidden="true" tabindex="-1"></a>  ts <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>,M)</span>
<span id="cb60-6"><a href="randomization-and-permutation-testing.html#cb60-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(m <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>M){</span>
<span id="cb60-7"><a href="randomization-and-permutation-testing.html#cb60-7" aria-hidden="true" tabindex="-1"></a>    permute.n <span class="ot">&lt;-</span> <span class="fu">sample.int</span>(n,n,<span class="at">replace =</span> F)</span>
<span id="cb60-8"><a href="randomization-and-permutation-testing.html#cb60-8" aria-hidden="true" tabindex="-1"></a>    re.randomized.group <span class="ot">&lt;-</span> df<span class="sc">$</span>Sex[permute.n]</span>
<span id="cb60-9"><a href="randomization-and-permutation-testing.html#cb60-9" aria-hidden="true" tabindex="-1"></a>    m0 <span class="ot">&lt;-</span> <span class="fu">mean</span>(df<span class="sc">$</span>Salary[re.randomized.group<span class="sc">==</span><span class="dv">0</span>])</span>
<span id="cb60-10"><a href="randomization-and-permutation-testing.html#cb60-10" aria-hidden="true" tabindex="-1"></a>    m1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(df<span class="sc">$</span>Salary[re.randomized.group<span class="sc">==</span><span class="dv">1</span>])</span>
<span id="cb60-11"><a href="randomization-and-permutation-testing.html#cb60-11" aria-hidden="true" tabindex="-1"></a>    s0 <span class="ot">&lt;-</span> <span class="fu">var</span>(df<span class="sc">$</span>Salary[re.randomized.group<span class="sc">==</span><span class="dv">0</span>])</span>
<span id="cb60-12"><a href="randomization-and-permutation-testing.html#cb60-12" aria-hidden="true" tabindex="-1"></a>    s1 <span class="ot">&lt;-</span> <span class="fu">var</span>(df<span class="sc">$</span>Salary[re.randomized.group<span class="sc">==</span><span class="dv">1</span>])</span>
<span id="cb60-13"><a href="randomization-and-permutation-testing.html#cb60-13" aria-hidden="true" tabindex="-1"></a>    ts[m] <span class="ot">&lt;-</span> (m0 <span class="sc">-</span> m1)<span class="sc">/</span><span class="fu">sqrt</span>(s0<span class="sc">/</span>n0<span class="sc">+</span>s1<span class="sc">/</span>n1)</span>
<span id="cb60-14"><a href="randomization-and-permutation-testing.html#cb60-14" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb60-15"><a href="randomization-and-permutation-testing.html#cb60-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(ts)</span>
<span id="cb60-16"><a href="randomization-and-permutation-testing.html#cb60-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb60-17"><a href="randomization-and-permutation-testing.html#cb60-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-18"><a href="randomization-and-permutation-testing.html#cb60-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-19"><a href="randomization-and-permutation-testing.html#cb60-19" aria-hidden="true" tabindex="-1"></a>grid.delta <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">400</span>, <span class="at">to =</span> <span class="dv">1400</span>, <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb60-20"><a href="randomization-and-permutation-testing.html#cb60-20" aria-hidden="true" tabindex="-1"></a>L <span class="ot">&lt;-</span> <span class="fu">length</span>(grid.delta)</span>
<span id="cb60-21"><a href="randomization-and-permutation-testing.html#cb60-21" aria-hidden="true" tabindex="-1"></a>p.value <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>,L)</span>
<span id="cb60-22"><a href="randomization-and-permutation-testing.html#cb60-22" aria-hidden="true" tabindex="-1"></a>reject<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="cn">NA</span>, L)            </span>
<span id="cb60-23"><a href="randomization-and-permutation-testing.html#cb60-23" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>L){</span>
<span id="cb60-24"><a href="randomization-and-permutation-testing.html#cb60-24" aria-hidden="true" tabindex="-1"></a>temp.df <span class="ot">&lt;-</span> salaries.df</span>
<span id="cb60-25"><a href="randomization-and-permutation-testing.html#cb60-25" aria-hidden="true" tabindex="-1"></a>temp.df<span class="sc">$</span>Salary[temp.df<span class="sc">$</span>Sex<span class="sc">==</span><span class="dv">1</span>]<span class="ot">&lt;-</span>temp.df<span class="sc">$</span>Salary[temp.df<span class="sc">$</span>Sex<span class="sc">==</span><span class="dv">1</span>]<span class="sc">-</span>grid.delta[j]</span>
<span id="cb60-26"><a href="randomization-and-permutation-testing.html#cb60-26" aria-hidden="true" tabindex="-1"></a>m0 <span class="ot">&lt;-</span> <span class="fu">mean</span>(temp.df<span class="sc">$</span>Salary[temp.df<span class="sc">$</span>Sex<span class="sc">==</span><span class="dv">0</span>])</span>
<span id="cb60-27"><a href="randomization-and-permutation-testing.html#cb60-27" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(temp.df<span class="sc">$</span>Salary[temp.df<span class="sc">$</span>Sex<span class="sc">==</span><span class="dv">1</span>])</span>
<span id="cb60-28"><a href="randomization-and-permutation-testing.html#cb60-28" aria-hidden="true" tabindex="-1"></a>s0 <span class="ot">&lt;-</span> <span class="fu">var</span>(temp.df<span class="sc">$</span>Salary[temp.df<span class="sc">$</span>Sex<span class="sc">==</span><span class="dv">0</span>])</span>
<span id="cb60-29"><a href="randomization-and-permutation-testing.html#cb60-29" aria-hidden="true" tabindex="-1"></a>s1 <span class="ot">&lt;-</span> <span class="fu">var</span>(temp.df<span class="sc">$</span>Salary[temp.df<span class="sc">$</span>Sex<span class="sc">==</span><span class="dv">1</span>])</span>
<span id="cb60-30"><a href="randomization-and-permutation-testing.html#cb60-30" aria-hidden="true" tabindex="-1"></a>t0 <span class="ot">&lt;-</span> (m0 <span class="sc">-</span> m1)<span class="sc">/</span><span class="fu">sqrt</span>(s0<span class="sc">/</span>n0<span class="sc">+</span>s1<span class="sc">/</span>n1)</span>
<span id="cb60-31"><a href="randomization-and-permutation-testing.html#cb60-31" aria-hidden="true" tabindex="-1"></a>test.vals.j <span class="ot">&lt;-</span> <span class="fu">randomization.test</span>(<span class="dv">10000</span>, temp.df)</span>
<span id="cb60-32"><a href="randomization-and-permutation-testing.html#cb60-32" aria-hidden="true" tabindex="-1"></a>mean.randomization <span class="ot">&lt;-</span> <span class="fu">mean</span>(test.vals.j)</span>
<span id="cb60-33"><a href="randomization-and-permutation-testing.html#cb60-33" aria-hidden="true" tabindex="-1"></a>p.value[j] <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(t0 <span class="sc">&gt;</span> mean.randomization,<span class="fu">sum</span>(<span class="fu">abs</span>(test.vals.j)<span class="sc">&gt;</span>t0)<span class="sc">/</span><span class="dv">10000</span>,<span class="fu">sum</span>(<span class="sc">-</span><span class="fu">abs</span>(test.vals.j)<span class="sc">&lt;</span>t0)<span class="sc">/</span><span class="dv">10000</span>)</span>
<span id="cb60-34"><a href="randomization-and-permutation-testing.html#cb60-34" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb60-35"><a href="randomization-and-permutation-testing.html#cb60-35" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(grid.delta, p.value)</span></code></pre></div>
<pre><code>##        grid.delta p.value
##   [1,]   400.0000  0.0040
##   [2,]   410.1010  0.0035
##   [3,]   420.2020  0.0060
##   [4,]   430.3030  0.0051
##   [5,]   440.4040  0.0097
##   [6,]   450.5051  0.0106
##   [7,]   460.6061  0.0143
##   [8,]   470.7071  0.0119
##   [9,]   480.8081  0.0168
##  [10,]   490.9091  0.0237
##  [11,]   501.0101  0.0279
##  [12,]   511.1111  0.0322
##  [13,]   521.2121  0.0401
##  [14,]   531.3131  0.0430
##  [15,]   541.4141  0.0515
##  [16,]   551.5152  0.0621
##  [17,]   561.6162  0.0765
##  [18,]   571.7172  0.0848
##  [19,]   581.8182  0.0943
##  [20,]   591.9192  0.1124
##  [21,]   602.0202  0.1218
##  [22,]   612.1212  0.1482
##  [23,]   622.2222  0.1718
##  [24,]   632.3232  0.1910
##  [25,]   642.4242  0.2207
##  [26,]   652.5253  0.2498
##  [27,]   662.6263  0.2701
##  [28,]   672.7273  0.3074
##  [29,]   682.8283  0.3417
##  [30,]   692.9293  0.3774
##  [31,]   703.0303  0.4171
##  [32,]   713.1313  0.4561
##  [33,]   723.2323  0.5007
##  [34,]   733.3333  0.5524
##  [35,]   743.4343  0.5968
##  [36,]   753.5354  0.6519
##  [37,]   763.6364  0.6970
##  [38,]   773.7374  0.7542
##  [39,]   783.8384  0.8093
##  [40,]   793.9394  0.8657
##  [41,]   804.0404  0.9225
##  [42,]   814.1414  0.9801
##  [43,]   824.2424  0.9654
##  [44,]   834.3434  0.9051
##  [45,]   844.4444  0.8566
##  [46,]   854.5455  0.7979
##  [47,]   864.6465  0.7320
##  [48,]   874.7475  0.6853
##  [49,]   884.8485  0.6395
##  [50,]   894.9495  0.5872
##  [51,]   905.0505  0.5317
##  [52,]   915.1515  0.4901
##  [53,]   925.2525  0.4425
##  [54,]   935.3535  0.4114
##  [55,]   945.4545  0.3667
##  [56,]   955.5556  0.3337
##  [57,]   965.6566  0.2968
##  [58,]   975.7576  0.2655
##  [59,]   985.8586  0.2435
##  [60,]   995.9596  0.2090
##  [61,]  1006.0606  0.1901
##  [62,]  1016.1616  0.1576
##  [63,]  1026.2626  0.1433
##  [64,]  1036.3636  0.1158
##  [65,]  1046.4646  0.1073
##  [66,]  1056.5657  0.0962
##  [67,]  1066.6667  0.0801
##  [68,]  1076.7677  0.0734
##  [69,]  1086.8687  0.0602
##  [70,]  1096.9697  0.0486
##  [71,]  1107.0707  0.0460
##  [72,]  1117.1717  0.0375
##  [73,]  1127.2727  0.0298
##  [74,]  1137.3737  0.0252
##  [75,]  1147.4747  0.0220
##  [76,]  1157.5758  0.0159
##  [77,]  1167.6768  0.0130
##  [78,]  1177.7778  0.0116
##  [79,]  1187.8788  0.0090
##  [80,]  1197.9798  0.0091
##  [81,]  1208.0808  0.0058
##  [82,]  1218.1818  0.0069
##  [83,]  1228.2828  0.0056
##  [84,]  1238.3838  0.0038
##  [85,]  1248.4848  0.0019
##  [86,]  1258.5859  0.0031
##  [87,]  1268.6869  0.0024
##  [88,]  1278.7879  0.0015
##  [89,]  1288.8889  0.0015
##  [90,]  1298.9899  0.0013
##  [91,]  1309.0909  0.0011
##  [92,]  1319.1919  0.0007
##  [93,]  1329.2929  0.0005
##  [94,]  1339.3939  0.0002
##  [95,]  1349.4949  0.0006
##  [96,]  1359.5960  0.0005
##  [97,]  1369.6970  0.0001
##  [98,]  1379.7980  0.0002
##  [99,]  1389.8990  0.0001
## [100,]  1400.0000  0.0001</code></pre>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="randomization-and-permutation-testing.html#cb62-1" aria-hidden="true" tabindex="-1"></a>midpoint <span class="ot">&lt;-</span> <span class="fu">which.max</span>(p.value)</span>
<span id="cb62-2"><a href="randomization-and-permutation-testing.html#cb62-2" aria-hidden="true" tabindex="-1"></a>lower.endpoint <span class="ot">&lt;-</span> grid.delta[<span class="fu">which.min</span>(<span class="fu">abs</span>(<span class="fl">0.05</span><span class="sc">-</span>p.value[<span class="dv">1</span><span class="sc">:</span>midpoint]))]</span>
<span id="cb62-3"><a href="randomization-and-permutation-testing.html#cb62-3" aria-hidden="true" tabindex="-1"></a>upper.endpoint <span class="ot">&lt;-</span> grid.delta[midpoint<span class="sc">+</span><span class="fu">which.min</span>(<span class="fu">abs</span>(<span class="fl">0.05</span><span class="sc">-</span>p.value[(midpoint<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>L]))]</span>
<span id="cb62-4"><a href="randomization-and-permutation-testing.html#cb62-4" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(lower.endpoint, upper.endpoint)</span></code></pre></div>
<pre><code>## [1]  541.4141 1096.9697</code></pre>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="introduction-to-linear-models.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="alternatives-for-non-normal-responses.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/03-RandomizationTests.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
