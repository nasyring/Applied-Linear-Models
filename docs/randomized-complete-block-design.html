<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 7 Randomized Complete Block Design | Applied Linear Models</title>
  <meta name="description" content="These are a collection of notes related to STAT 500 at Iowa State University. This is a work in progress." />
  <meta name="generator" content="bookdown 0.29 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 7 Randomized Complete Block Design | Applied Linear Models" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="These are a collection of notes related to STAT 500 at Iowa State University. This is a work in progress." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 7 Randomized Complete Block Design | Applied Linear Models" />
  
  <meta name="twitter:description" content="These are a collection of notes related to STAT 500 at Iowa State University. This is a work in progress." />
  

<meta name="author" content="Nick Syring" />


<meta name="date" content="2022-10-27" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="one-way-anova.html"/>
<link rel="next" href="latin-squares-for-two-blocking-variables.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Applied Linear Models</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> About</a></li>
<li class="chapter" data-level="2" data-path="data-analysis-and-statistical-inference.html"><a href="data-analysis-and-statistical-inference.html"><i class="fa fa-check"></i><b>2</b> Data Analysis and Statistical Inference</a>
<ul>
<li class="chapter" data-level="2.1" data-path="data-analysis-and-statistical-inference.html"><a href="data-analysis-and-statistical-inference.html#data-experiments-and-studies"><i class="fa fa-check"></i><b>2.1</b> Data, Experiments, and Studies</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="data-analysis-and-statistical-inference.html"><a href="data-analysis-and-statistical-inference.html#james-linds-scurvy-trial"><i class="fa fa-check"></i><b>2.1.1</b> James Lind’s Scurvy Trial</a></li>
<li class="chapter" data-level="2.1.2" data-path="data-analysis-and-statistical-inference.html"><a href="data-analysis-and-statistical-inference.html#framingham-heart-study"><i class="fa fa-check"></i><b>2.1.2</b> Framingham Heart Study</a></li>
<li class="chapter" data-level="2.1.3" data-path="data-analysis-and-statistical-inference.html"><a href="data-analysis-and-statistical-inference.html#harris-bank-sex-pay-study"><i class="fa fa-check"></i><b>2.1.3</b> Harris Bank Sex Pay Study</a></li>
<li class="chapter" data-level="2.1.4" data-path="data-analysis-and-statistical-inference.html"><a href="data-analysis-and-statistical-inference.html#large-aggregated-data-sets"><i class="fa fa-check"></i><b>2.1.4</b> Large, Aggregated Data Sets</a></li>
<li class="chapter" data-level="2.1.5" data-path="data-analysis-and-statistical-inference.html"><a href="data-analysis-and-statistical-inference.html#study-concepts"><i class="fa fa-check"></i><b>2.1.5</b> Study Concepts</a></li>
<li class="chapter" data-level="2.1.6" data-path="data-analysis-and-statistical-inference.html"><a href="data-analysis-and-statistical-inference.html#randomization-control-and-causation"><i class="fa fa-check"></i><b>2.1.6</b> Randomization, control, and causation</a></li>
<li class="chapter" data-level="2.1.7" data-path="data-analysis-and-statistical-inference.html"><a href="data-analysis-and-statistical-inference.html#populations-and-scope-of-inference"><i class="fa fa-check"></i><b>2.1.7</b> Populations and scope of inference</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="data-analysis-and-statistical-inference.html"><a href="data-analysis-and-statistical-inference.html#data-summaries"><i class="fa fa-check"></i><b>2.2</b> Data Summaries</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="data-analysis-and-statistical-inference.html"><a href="data-analysis-and-statistical-inference.html#numerical-summaries"><i class="fa fa-check"></i><b>2.2.1</b> Numerical Summaries</a></li>
<li class="chapter" data-level="2.2.2" data-path="data-analysis-and-statistical-inference.html"><a href="data-analysis-and-statistical-inference.html#visual-summaries"><i class="fa fa-check"></i><b>2.2.2</b> Visual Summaries</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="data-analysis-and-statistical-inference.html"><a href="data-analysis-and-statistical-inference.html#statistical-inference"><i class="fa fa-check"></i><b>2.3</b> Statistical Inference</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="introduction-to-linear-models.html"><a href="introduction-to-linear-models.html"><i class="fa fa-check"></i><b>3</b> Introduction to Linear Models</a>
<ul>
<li class="chapter" data-level="3.1" data-path="introduction-to-linear-models.html"><a href="introduction-to-linear-models.html#defining-the-linear-model"><i class="fa fa-check"></i><b>3.1</b> Defining the linear model</a></li>
<li class="chapter" data-level="3.2" data-path="introduction-to-linear-models.html"><a href="introduction-to-linear-models.html#gauss-markov-model-for-one-sample"><i class="fa fa-check"></i><b>3.2</b> Gauss-Markov model for one sample</a></li>
<li class="chapter" data-level="3.3" data-path="introduction-to-linear-models.html"><a href="introduction-to-linear-models.html#gauss-markov-model-for-comparing-two-samples"><i class="fa fa-check"></i><b>3.3</b> Gauss-Markov model for comparing two samples</a></li>
<li class="chapter" data-level="3.4" data-path="introduction-to-linear-models.html"><a href="introduction-to-linear-models.html#pairwise-testing-and-bonferroni-correction"><i class="fa fa-check"></i><b>3.4</b> Pairwise testing and Bonferroni correction</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="introduction-to-linear-models.html"><a href="introduction-to-linear-models.html#example-co2-uptake-in-echinochloa-crus-galli"><i class="fa fa-check"></i><b>3.4.1</b> Example: Co2 uptake in Echinochloa crus-galli</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="introduction-to-linear-models.html"><a href="introduction-to-linear-models.html#linear-models-for-more-than-two-treatments-populations"><i class="fa fa-check"></i><b>3.5</b> Linear Models for more than two treatments (populations)</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="randomization-and-permutation-testing.html"><a href="randomization-and-permutation-testing.html"><i class="fa fa-check"></i><b>4</b> Randomization and Permutation Testing</a>
<ul>
<li class="chapter" data-level="4.1" data-path="randomization-and-permutation-testing.html"><a href="randomization-and-permutation-testing.html#setup"><i class="fa fa-check"></i><b>4.1</b> Setup</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="randomization-and-permutation-testing.html"><a href="randomization-and-permutation-testing.html#example-1-the-harris-bank-sex-pay-study"><i class="fa fa-check"></i><b>4.1.1</b> Example 1: The Harris Bank Sex Pay Study</a></li>
<li class="chapter" data-level="4.1.2" data-path="randomization-and-permutation-testing.html"><a href="randomization-and-permutation-testing.html#difference-in-mean-salaries-between-genders"><i class="fa fa-check"></i><b>4.1.2</b> Difference in mean salaries between genders</a></li>
<li class="chapter" data-level="4.1.3" data-path="randomization-and-permutation-testing.html"><a href="randomization-and-permutation-testing.html#randomization-test-for-treatment-significance"><i class="fa fa-check"></i><b>4.1.3</b> Randomization test for treatment significance</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="alternatives-for-non-normal-responses.html"><a href="alternatives-for-non-normal-responses.html"><i class="fa fa-check"></i><b>5</b> Alternatives for Non-Normal Responses</a>
<ul>
<li class="chapter" data-level="5.1" data-path="alternatives-for-non-normal-responses.html"><a href="alternatives-for-non-normal-responses.html#transformations"><i class="fa fa-check"></i><b>5.1</b> Transformations</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="alternatives-for-non-normal-responses.html"><a href="alternatives-for-non-normal-responses.html#example-cloud-seeding-for-rainfall"><i class="fa fa-check"></i><b>5.1.1</b> Example: Cloud Seeding for Rainfall</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="alternatives-for-non-normal-responses.html"><a href="alternatives-for-non-normal-responses.html#rank-sum-test"><i class="fa fa-check"></i><b>5.2</b> Rank-Sum Test</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="alternatives-for-non-normal-responses.html"><a href="alternatives-for-non-normal-responses.html#example-ratio-measurements"><i class="fa fa-check"></i><b>5.2.1</b> Example: ratio measurements</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="alternatives-for-non-normal-responses.html"><a href="alternatives-for-non-normal-responses.html#signed-rank-test"><i class="fa fa-check"></i><b>5.3</b> Signed-rank test</a></li>
<li class="chapter" data-level="5.4" data-path="alternatives-for-non-normal-responses.html"><a href="alternatives-for-non-normal-responses.html#bootstrap"><i class="fa fa-check"></i><b>5.4</b> Bootstrap</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="alternatives-for-non-normal-responses.html"><a href="alternatives-for-non-normal-responses.html#intro-to-the-bootstrap"><i class="fa fa-check"></i><b>5.4.1</b> Intro to the bootstrap</a></li>
<li class="chapter" data-level="5.4.2" data-path="alternatives-for-non-normal-responses.html"><a href="alternatives-for-non-normal-responses.html#bootstrap-confidence-intervals"><i class="fa fa-check"></i><b>5.4.2</b> Bootstrap Confidence Intervals</a></li>
<li class="chapter" data-level="5.4.3" data-path="alternatives-for-non-normal-responses.html"><a href="alternatives-for-non-normal-responses.html#bootstrapping-linear-models"><i class="fa fa-check"></i><b>5.4.3</b> Bootstrapping linear models</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="one-way-anova.html"><a href="one-way-anova.html"><i class="fa fa-check"></i><b>6</b> One Way ANOVA</a>
<ul>
<li class="chapter" data-level="6.1" data-path="one-way-anova.html"><a href="one-way-anova.html#the-gauss-markov-model-for-comparing-i-populations"><i class="fa fa-check"></i><b>6.1</b> The Gauss-Markov Model for comparing I populations</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="one-way-anova.html"><a href="one-way-anova.html#example-donuts-effects-model"><i class="fa fa-check"></i><b>6.1.1</b> Example: Donuts effects model</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="one-way-anova.html"><a href="one-way-anova.html#testing-equality-of-means"><i class="fa fa-check"></i><b>6.2</b> Testing equality of means</a></li>
<li class="chapter" data-level="6.3" data-path="one-way-anova.html"><a href="one-way-anova.html#follow-up-testing"><i class="fa fa-check"></i><b>6.3</b> Follow-up testing</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="one-way-anova.html"><a href="one-way-anova.html#donuts-example"><i class="fa fa-check"></i><b>6.3.1</b> Donuts example</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="one-way-anova.html"><a href="one-way-anova.html#inference-for-particular-contrasts"><i class="fa fa-check"></i><b>6.4</b> Inference for particular contrasts</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="one-way-anova.html"><a href="one-way-anova.html#donuts-example-1"><i class="fa fa-check"></i><b>6.4.1</b> Donuts Example</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="one-way-anova.html"><a href="one-way-anova.html#checking-assumptions-in-one-way-anova"><i class="fa fa-check"></i><b>6.5</b> Checking Assumptions in one-way ANOVA</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="one-way-anova.html"><a href="one-way-anova.html#example-cehcking-assumptions-for-donuts-experiment"><i class="fa fa-check"></i><b>6.5.1</b> Example: Cehcking assumptions for donuts experiment</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="randomized-complete-block-design.html"><a href="randomized-complete-block-design.html"><i class="fa fa-check"></i><b>7</b> Randomized Complete Block Design</a>
<ul>
<li class="chapter" data-level="7.1" data-path="randomized-complete-block-design.html"><a href="randomized-complete-block-design.html#paired-experiments-as-blocking"><i class="fa fa-check"></i><b>7.1</b> Paired experiments as blocking</a></li>
<li class="chapter" data-level="7.2" data-path="randomized-complete-block-design.html"><a href="randomized-complete-block-design.html#randomized-complete-block-designs"><i class="fa fa-check"></i><b>7.2</b> Randomized Complete Block Designs</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="randomized-complete-block-design.html"><a href="randomized-complete-block-design.html#notation"><i class="fa fa-check"></i><b>7.2.1</b> Notation</a></li>
<li class="chapter" data-level="7.2.2" data-path="randomized-complete-block-design.html"><a href="randomized-complete-block-design.html#example-penicillin-manufacturing"><i class="fa fa-check"></i><b>7.2.2</b> Example: Penicillin Manufacturing</a></li>
<li class="chapter" data-level="7.2.3" data-path="randomized-complete-block-design.html"><a href="randomized-complete-block-design.html#sums-of-squares-and-f-tests-in-rcbd"><i class="fa fa-check"></i><b>7.2.3</b> Sums of squares and F tests in RCBD</a></li>
<li class="chapter" data-level="7.2.4" data-path="randomized-complete-block-design.html"><a href="randomized-complete-block-design.html#example-significance-of-process-in-penicillin-experiment"><i class="fa fa-check"></i><b>7.2.4</b> Example: Significance of Process in Penicillin experiment</a></li>
<li class="chapter" data-level="7.2.5" data-path="randomized-complete-block-design.html"><a href="randomized-complete-block-design.html#follow-up-comparisons-and-contrasts"><i class="fa fa-check"></i><b>7.2.5</b> Follow-up comparisons and contrasts</a></li>
<li class="chapter" data-level="7.2.6" data-path="randomized-complete-block-design.html"><a href="randomized-complete-block-design.html#example-tukey-contrasts-and-scheffe-for-penicillin-experiment"><i class="fa fa-check"></i><b>7.2.6</b> Example: Tukey, contrasts, and Scheffe for penicillin experiment</a></li>
<li class="chapter" data-level="7.2.7" data-path="randomized-complete-block-design.html"><a href="randomized-complete-block-design.html#relative-efficiency-of-blocking-vs.-crd"><i class="fa fa-check"></i><b>7.2.7</b> Relative efficiency of Blocking (vs. CRD)</a></li>
<li class="chapter" data-level="7.2.8" data-path="randomized-complete-block-design.html"><a href="randomized-complete-block-design.html#example-re-of-blocking-in-penicillin-experiment"><i class="fa fa-check"></i><b>7.2.8</b> Example: RE of blocking in penicillin experiment</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="latin-squares-for-two-blocking-variables.html"><a href="latin-squares-for-two-blocking-variables.html"><i class="fa fa-check"></i><b>8</b> Latin Squares for two blocking variables</a>
<ul>
<li class="chapter" data-level="8.1" data-path="latin-squares-for-two-blocking-variables.html"><a href="latin-squares-for-two-blocking-variables.html#designs-for-multiple-blocks"><i class="fa fa-check"></i><b>8.1</b> Designs for multiple blocks</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="latin-squares-for-two-blocking-variables.html"><a href="latin-squares-for-two-blocking-variables.html#example-mpg-experiment"><i class="fa fa-check"></i><b>8.1.1</b> Example: MPG experiment</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="latin-squares-for-two-blocking-variables.html"><a href="latin-squares-for-two-blocking-variables.html#model-notation"><i class="fa fa-check"></i><b>8.2</b> Model notation</a></li>
<li class="chapter" data-level="8.3" data-path="latin-squares-for-two-blocking-variables.html"><a href="latin-squares-for-two-blocking-variables.html#sums-of-squares-and-test-for-treatment-effects"><i class="fa fa-check"></i><b>8.3</b> Sums of squares and test for treatment effects</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="latin-squares-for-two-blocking-variables.html"><a href="latin-squares-for-two-blocking-variables.html#example-mpg-experiment-1"><i class="fa fa-check"></i><b>8.3.1</b> Example: MPG experiment</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="latin-squares-for-two-blocking-variables.html"><a href="latin-squares-for-two-blocking-variables.html#relative-efficiency-of-blocking"><i class="fa fa-check"></i><b>8.4</b> Relative efficiency of blocking</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="latin-squares-for-two-blocking-variables.html"><a href="latin-squares-for-two-blocking-variables.html#example-re-ignoring-driver-blocks"><i class="fa fa-check"></i><b>8.4.1</b> Example: RE ignoring driver blocks</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="two-way-anova.html"><a href="two-way-anova.html"><i class="fa fa-check"></i><b>9</b> Two-Way ANOVA</a>
<ul>
<li class="chapter" data-level="9.1" data-path="two-way-anova.html"><a href="two-way-anova.html#the-model"><i class="fa fa-check"></i><b>9.1</b> The Model</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="two-way-anova.html"><a href="two-way-anova.html#example-protein-chemistry"><i class="fa fa-check"></i><b>9.1.1</b> Example: protein chemistry</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="two-way-anova.html"><a href="two-way-anova.html#tests-for-interaction-and-main-effects"><i class="fa fa-check"></i><b>9.2</b> Tests for interaction and main effects</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="two-way-anova.html"><a href="two-way-anova.html#example-protein-and-dietary-metals"><i class="fa fa-check"></i><b>9.2.1</b> Example: Protein and dietary metals</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="unbalanced-data-in-two-way-anova.html"><a href="unbalanced-data-in-two-way-anova.html"><i class="fa fa-check"></i><b>10</b> Unbalanced data in Two-Way ANOVA</a>
<ul>
<li class="chapter" data-level="10.1" data-path="unbalanced-data-in-two-way-anova.html"><a href="unbalanced-data-in-two-way-anova.html#raw-and-least-squares-means"><i class="fa fa-check"></i><b>10.1</b> Raw and Least-Squares Means</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="unbalanced-data-in-two-way-anova.html"><a href="unbalanced-data-in-two-way-anova.html#example-turbine-data"><i class="fa fa-check"></i><b>10.1.1</b> Example: Turbine data</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="unbalanced-data-in-two-way-anova.html"><a href="unbalanced-data-in-two-way-anova.html#partial-f-tests-and-type-iii-ss"><i class="fa fa-check"></i><b>10.2</b> Partial F tests and Type III SS</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="unbalanced-data-in-two-way-anova.html"><a href="unbalanced-data-in-two-way-anova.html#example-turbine-data-tests"><i class="fa fa-check"></i><b>10.2.1</b> Example: Turbine Data tests</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="unbalanced-data-in-two-way-anova.html"><a href="unbalanced-data-in-two-way-anova.html#follow-up-tests"><i class="fa fa-check"></i><b>10.3</b> Follow-up tests</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="unbalanced-data-in-two-way-anova.html"><a href="unbalanced-data-in-two-way-anova.html#example-turbine-data-tukey-corrected-pairwise-comparisons"><i class="fa fa-check"></i><b>10.3.1</b> Example: Turbine data Tukey-corrected pairwise comparisons</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="unbalanced-data-in-two-way-anova.html"><a href="unbalanced-data-in-two-way-anova.html#unbalanced-data-and-simpsons-paradox"><i class="fa fa-check"></i><b>10.4</b> Unbalanced data and Simpson’s Paradox</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="missing-cells-in-two-way-anova.html"><a href="missing-cells-in-two-way-anova.html"><i class="fa fa-check"></i><b>11</b> Missing Cells in Two-Way ANOVA</a>
<ul>
<li class="chapter" data-level="11.1" data-path="missing-cells-in-two-way-anova.html"><a href="missing-cells-in-two-way-anova.html#anova-with-missing-at-random-cell"><i class="fa fa-check"></i><b>11.1</b> ANOVA with missing “at random” cell</a></li>
<li class="chapter" data-level="11.2" data-path="missing-cells-in-two-way-anova.html"><a href="missing-cells-in-two-way-anova.html#do-any-of-the-treatments-matter"><i class="fa fa-check"></i><b>11.2</b> Do any of the treatments matter?</a></li>
<li class="chapter" data-level="11.3" data-path="missing-cells-in-two-way-anova.html"><a href="missing-cells-in-two-way-anova.html#fit-a-linear-model-with-additional-constraints"><i class="fa fa-check"></i><b>11.3</b> Fit a linear model with additional constraints</a></li>
<li class="chapter" data-level="11.4" data-path="missing-cells-in-two-way-anova.html"><a href="missing-cells-in-two-way-anova.html#general-linear-test-for-interaction"><i class="fa fa-check"></i><b>11.4</b> General Linear Test for interaction</a></li>
<li class="chapter" data-level="11.5" data-path="missing-cells-in-two-way-anova.html"><a href="missing-cells-in-two-way-anova.html#partial-analysis-for-interaction"><i class="fa fa-check"></i><b>11.5</b> Partial analysis for interaction</a></li>
<li class="chapter" data-level="11.6" data-path="missing-cells-in-two-way-anova.html"><a href="missing-cells-in-two-way-anova.html#tests-for-main-effects-in-the-partial-table"><i class="fa fa-check"></i><b>11.6</b> Tests for main effects in the partial table</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="strategy-for-analysis-in-two-factor-models.html"><a href="strategy-for-analysis-in-two-factor-models.html"><i class="fa fa-check"></i><b>12</b> Strategy for Analysis in Two-Factor models</a>
<ul>
<li class="chapter" data-level="12.1" data-path="strategy-for-analysis-in-two-factor-models.html"><a href="strategy-for-analysis-in-two-factor-models.html#unbalanced-two-factor-experiment-chick-weight"><i class="fa fa-check"></i><b>12.1</b> Unbalanced Two-Factor Experiment: Chick Weight</a></li>
<li class="chapter" data-level="12.2" data-path="strategy-for-analysis-in-two-factor-models.html"><a href="strategy-for-analysis-in-two-factor-models.html#example-observational-study-on-growth-hormone-deficient-children-with-empty-cell"><i class="fa fa-check"></i><b>12.2</b> Example: observational study on growth-hormone deficient children with empty cell</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="strategy-for-analysis-in-two-factor-models.html"><a href="strategy-for-analysis-in-two-factor-models.html#linear-model-analysis-with-extra-constraint"><i class="fa fa-check"></i><b>12.2.1</b> Linear Model analysis with extra constraint</a></li>
<li class="chapter" data-level="12.2.2" data-path="strategy-for-analysis-in-two-factor-models.html"><a href="strategy-for-analysis-in-two-factor-models.html#partial-table-analysis"><i class="fa fa-check"></i><b>12.2.2</b> Partial Table analysis</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="k-factorial-experiments.html"><a href="k-factorial-experiments.html"><i class="fa fa-check"></i><b>13</b> <span class="math inline">\(2^k\)</span> Factorial Experiments</a>
<ul>
<li class="chapter" data-level="13.1" data-path="k-factorial-experiments.html"><a href="k-factorial-experiments.html#the-model-1"><i class="fa fa-check"></i><b>13.1</b> The Model</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="k-factorial-experiments.html"><a href="k-factorial-experiments.html#example-stress-test-study"><i class="fa fa-check"></i><b>13.1.1</b> Example: Stress Test Study</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="k-factorial-experiments.html"><a href="k-factorial-experiments.html#unreplicated-factorial-experiments"><i class="fa fa-check"></i><b>13.2</b> Unreplicated Factorial Experiments</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="k-factorial-experiments.html"><a href="k-factorial-experiments.html#example-granola-bar-experiment"><i class="fa fa-check"></i><b>13.2.1</b> Example: Granola bar experiment</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Applied Linear Models</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="randomized-complete-block-design" class="section level1 hasAnchor" number="7">
<h1><span class="header-section-number">Chapter 7</span> Randomized Complete Block Design<a href="randomized-complete-block-design.html#randomized-complete-block-design" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In this chapter we discuss the technique of <em>blocking</em> which means to sample individuals from groups that are known (or strongly suspected) to have different average responses. Blocking is a type of explicit control—we account for the known effect of the blocks on the response through our sampling/experimental design. The effect of including blocks is (usually) to reduce the remaining variability in the response, thereby making it easier to detect treatment effects. One way to visualize this blocking effect is to recall the sum of squares decomposition SST = SSE + SSTr. When blocks are utilized, the decomposition becomes SST = SSE + SSBl + SSTr. The block sum of squares tends to absorb mostly the SSE term, thereby reducing the SSE and making the F ratio for treatments larger. However, some of the information of the data is “used up” estimating the block effects, and this reduces the degrees of freedom associated with MSE. Therefore, if “useless” blocks are used, we will tend to lose efficiency/power in detecting treatment effects.</p>
<div id="paired-experiments-as-blocking" class="section level2 hasAnchor" number="7.1">
<h2><span class="header-section-number">7.1</span> Paired experiments as blocking<a href="randomized-complete-block-design.html#paired-experiments-as-blocking" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We are already familiar with blocking in a special type of two-sample experiment—paired data. For example, consider a paired design where responses on <span class="math inline">\(n\)</span> individuals are measured as <span class="math inline">\(X_i\)</span> “before” and <span class="math inline">\(Y_i\)</span> “after” a treatment. The individuals constitute <span class="math inline">\(n\)</span> blocks, with one sample, the difference <span class="math inline">\(D_i = Y_i - X_i\)</span>, for each block. The variance of <span class="math inline">\(D_i\)</span> is <span class="math inline">\(V(D_i) = V(X_i) + V(Y_i) - 2Cov(X_i, Y_i)\)</span>. In a two-sample experiment where two different groups of individuals are treated, the covariance of responses between groups is zero. However, if multiple measurements are taken on the same individual, we generally expect the covariance of those measurements to be positive. Therefore, intuitively, we would expect the variance of differences of observations on the same individual to be lower than the variance of the difference of responses on two different individuals.</p>
</div>
<div id="randomized-complete-block-designs" class="section level2 hasAnchor" number="7.2">
<h2><span class="header-section-number">7.2</span> Randomized Complete Block Designs<a href="randomized-complete-block-design.html#randomized-complete-block-designs" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="notation" class="section level3 hasAnchor" number="7.2.1">
<h3><span class="header-section-number">7.2.1</span> Notation<a href="randomized-complete-block-design.html#notation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We will use the following notation:<br>
- <span class="math inline">\(n\)</span> is the number of blocks<br>
- <span class="math inline">\(J\)</span> is the number of treatments<br>
- <span class="math inline">\(r\)</span> is the number of replications of each treatment in a block. So, each block has <span class="math inline">\(rJ\)</span> responses.<br>
- Y_{ijk} is the response for the <span class="math inline">\(i^{th}\)</span> block for treatment <span class="math inline">\(j\)</span> at the <span class="math inline">\(k^{th}\)</span> replicate. <br>
- <span class="math inline">\(\overline Y_{i\cdot\cdot} = (rJ)^{-1}\sum_{j=1}^J\sum_{k=1}^r Y_{ijk}\)</span> is the sample mean response of <span class="math inline">\(i^{th}\)</span> block <br>
- <span class="math inline">\(\overline Y_{\cdot j \cdot} = (rn)^{-1}\sum_{i=1}^n\sum_{k=1}^r Y_{ijk}\)</span> is the sample mean response of <span class="math inline">\(j^{th}\)</span> treatment <br>
- <span class="math inline">\(\overline Y_{\cdot\cdot\cdot} = (rJn)^{-1}\sum_{i=1}^n\sum_{j=1}^J\sum_{k=1}^r Y_{ijk}\)</span> is the sample mean response of all the responses, the grand sample mean.
<br><br>
In single replication studies, <span class="math inline">\(r=1\)</span> and the third subscript is dropped from the notation.<br><br></p>
<p>The model may be written in the following effects-style notation:</p>
<p><span class="math display">\[Y_{ijk} = \mu + \beta_i + \tau_j + \epsilon_{ijk}\]</span></p>
<p>where <span class="math inline">\(\mu\)</span> is an “intercept” term equal to <span class="math inline">\(E(Y_{ijk})\)</span> if the other effects are actually zero; <span class="math inline">\(\beta_i\)</span> for <span class="math inline">\(i=1, \ldots, n\)</span> are the block effects, <span class="math inline">\(\tau_j\)</span> for <span class="math inline">\(j = 1, \ldots, J\)</span> are the treatment effects, and <span class="math inline">\(\epsilon_{ijk}\)</span> is the effect of random sampling variability where <span class="math inline">\(\epsilon_{ijk}\stackrel{iid}{\sim}N(0,\sigma^2)\)</span>. <br><br></p>
<p>The above model requires two constraints in order to estimate the parameters <span class="math inline">\((\mu, \beta_i, \tau_j)\)</span> for all <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span>. Here is the problem: the estimates of these parameters will be functions of the <span class="math inline">\(1 + n + J\)</span> sample means above (the grand sample mean, block and treatment sample means). But, these are not all freely varying. For instance, since <span class="math inline">\(\overline Y_{\cdot\cdot\cdot} = (J)^{-1}\sum_{j=1}^J \overline Y_{\cdot j \cdot}\)</span>, it follows that we only need to know <span class="math inline">\(J-1\)</span> of the <span class="math inline">\(J\)</span> treatment sample means <span class="math inline">\(\overline Y_{\cdot j \cdot}\)</span> and <span class="math inline">\(\overline Y_{\cdot\cdot\cdot}\)</span> in order to determine the last one. The same is true of the block sample means. This means we must introduce two constraints on the parameters <span class="math inline">\((\mu, \beta_i, \tau_j)\)</span> for all <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span> to avoid defining parameters that are simply linear combinations of other parameters.<br><br></p>
<p>There are two common choices, the baseline constraints and the sum-to-zero constraints. Under the baseline constraints we set one of the treatment effects and one of the block effects to zero. Often, we would set <span class="math inline">\(\beta_n = 0\)</span> and <span class="math inline">\(\tau_J = 0\)</span>, but sometimes (in some software) the first rather than last effects are set to zero. Whichever are set to zero are absorbed by <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\mu\)</span> becomes the “baseline” effect. The remaining non-zero effects represent departures from the baseline. The second common constraint is the sum-to-zero constraint, which forces <span class="math inline">\(\sum \beta_i = \sum \tau_j = 0\)</span>. This constraint causes <span class="math inline">\(\mu\)</span> to become the overall average response, and the effects to represent departures from the average.</p>
</div>
<div id="example-penicillin-manufacturing" class="section level3 hasAnchor" number="7.2.2">
<h3><span class="header-section-number">7.2.2</span> Example: Penicillin Manufacturing<a href="randomized-complete-block-design.html#example-penicillin-manufacturing" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In this example 5 batches of raw organic material are used to make the antibiotic penicillin. We are interested in the yield of penicillin using 4 different industrial processes. Each process is used once per batch.</p>
<a href="data:text/csv;base64,QmF0Y2gsUHJvY2VzcyxZaWVsZA0KMSxBLDg5DQoxLEIsODgNCjEsQyw5Nw0KMSxELDk0DQoyLEEsODQNCjIsQiw3Nw0KMixDLDkyDQoyLEQsNzkNCjMsQSw4MQ0KMyxCLDg3DQozLEMsODcNCjMsRCw4NQ0KNCxBLDg3DQo0LEIsOTINCjQsQyw4OQ0KNCxELDg0DQo1LEEsNzkNCjUsQiw4MQ0KNSxDLDgwDQo1LEQsODgNCg==" download="penicillin.csv">Download penicillin.csv</a>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb216-1"><a href="randomized-complete-block-design.html#cb216-1" aria-hidden="true" tabindex="-1"></a>penicillin <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&#39;penicillin.csv&#39;</span>)</span>
<span id="cb216-2"><a href="randomized-complete-block-design.html#cb216-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(penicillin)</span></code></pre></div>
<pre><code>##   Batch Process Yield
## 1     1       A    89
## 2     1       B    88
## 3     1       C    97
## 4     1       D    94
## 5     2       A    84
## 6     2       B    77</code></pre>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="randomized-complete-block-design.html#cb218-1" aria-hidden="true" tabindex="-1"></a>penicillin<span class="sc">$</span>Batch <span class="ot">&lt;-</span> <span class="fu">factor</span>(penicillin<span class="sc">$</span>Batch, <span class="at">levels =</span> <span class="fu">unique</span>(penicillin<span class="sc">$</span>Batch))</span>
<span id="cb218-2"><a href="randomized-complete-block-design.html#cb218-2" aria-hidden="true" tabindex="-1"></a>penicillin<span class="sc">$</span>Process <span class="ot">&lt;-</span> <span class="fu">factor</span>(penicillin<span class="sc">$</span>Process, <span class="at">levels =</span> <span class="fu">unique</span>(penicillin<span class="sc">$</span>Process))</span></code></pre></div>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb219-1"><a href="randomized-complete-block-design.html#cb219-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(Yield <span class="sc">~</span> Process,</span>
<span id="cb219-2"><a href="randomized-complete-block-design.html#cb219-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> penicillin)</span></code></pre></div>
<p><img src="06-RCBD_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<p>Let’s see what parameter estimates R produces for the penicillin data. From the output of the lm function we see that treatment A and Batch 1 are missing—these are the baseline and are reflected in the intercept estimate, which is 90. How did R get 90? Well, the overall sample mean is 86; the process A mean yield is 84, and the batch 1 mean yield is 92. So, the effect of process A compared to the overall average is -2 and the effect of batch 1 compared to the overall average is +8. This combines for +6, so we end up with a batch1+processA baseline effect of 90 = 84+6. The rest of the effect estimates are easy to obtain as differences from this baseline. For example, since process B has a sample mean 1 larger than A, the process B effect is 1. And, since batch 3 has a sample mean effect 7 less than batch 1 the batch 3 effect is -7, and so on.</p>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="randomized-complete-block-design.html#cb220-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
<pre><code>## ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.2 ──
## ✔ ggplot2 3.3.6      ✔ purrr   0.3.4 
## ✔ tibble  3.1.8      ✔ dplyr   1.0.10
## ✔ tidyr   1.2.1      ✔ stringr 1.4.1 
## ✔ readr   2.1.2      ✔ forcats 0.5.2 
## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
## ✖ dplyr::filter() masks stats::filter()
## ✖ dplyr::lag()    masks stats::lag()</code></pre>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb222-1"><a href="randomized-complete-block-design.html#cb222-1" aria-hidden="true" tabindex="-1"></a>by_batch <span class="ot">&lt;-</span> <span class="fu">group_by</span>(penicillin, Batch)</span>
<span id="cb222-2"><a href="randomized-complete-block-design.html#cb222-2" aria-hidden="true" tabindex="-1"></a>by_batch <span class="ot">&lt;-</span> <span class="fu">summarise</span>(by_batch, <span class="at">batch_mean =</span> <span class="fu">mean</span>(Yield))</span>
<span id="cb222-3"><a href="randomized-complete-block-design.html#cb222-3" aria-hidden="true" tabindex="-1"></a>by_batch</span></code></pre></div>
<pre><code>## # A tibble: 5 × 2
##   Batch batch_mean
##   &lt;fct&gt;      &lt;dbl&gt;
## 1 1             92
## 2 2             83
## 3 3             85
## 4 4             88
## 5 5             82</code></pre>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb224-1"><a href="randomized-complete-block-design.html#cb224-1" aria-hidden="true" tabindex="-1"></a>by_trt <span class="ot">&lt;-</span> <span class="fu">group_by</span>(penicillin, Process)</span>
<span id="cb224-2"><a href="randomized-complete-block-design.html#cb224-2" aria-hidden="true" tabindex="-1"></a>by_trt <span class="ot">&lt;-</span> <span class="fu">summarise</span>(by_trt, <span class="at">trt_mean =</span> <span class="fu">mean</span>(Yield))</span>
<span id="cb224-3"><a href="randomized-complete-block-design.html#cb224-3" aria-hidden="true" tabindex="-1"></a>by_trt</span></code></pre></div>
<pre><code>## # A tibble: 4 × 2
##   Process trt_mean
##   &lt;fct&gt;      &lt;dbl&gt;
## 1 A             84
## 2 B             85
## 3 C             89
## 4 D             86</code></pre>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb226-1"><a href="randomized-complete-block-design.html#cb226-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(penicillin<span class="sc">$</span>Yield)</span></code></pre></div>
<pre><code>## [1] 86</code></pre>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb228-1"><a href="randomized-complete-block-design.html#cb228-1" aria-hidden="true" tabindex="-1"></a>my.lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(Yield<span class="sc">~</span>Process<span class="sc">+</span>Batch, <span class="at">data =</span> penicillin)</span>
<span id="cb228-2"><a href="randomized-complete-block-design.html#cb228-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(my.lm)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Yield ~ Process + Batch, data = penicillin)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
##  -5.00  -2.25  -0.50   2.25   6.00 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   90.000      2.745  32.791  4.1e-13 ***
## ProcessB       1.000      2.745   0.364  0.72194    
## ProcessC       5.000      2.745   1.822  0.09351 .  
## ProcessD       2.000      2.745   0.729  0.48018    
## Batch2        -9.000      3.069  -2.933  0.01254 *  
## Batch3        -7.000      3.069  -2.281  0.04159 *  
## Batch4        -4.000      3.069  -1.304  0.21686    
## Batch5       -10.000      3.069  -3.259  0.00684 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 4.34 on 12 degrees of freedom
## Multiple R-squared:  0.5964, Adjusted R-squared:  0.361 
## F-statistic: 2.534 on 7 and 12 DF,  p-value: 0.07535</code></pre>
<p>The <em>options</em> statement below causes R to use the sum-to-zero constraints. We can see the resulting parameter estimates are now in terms of differences from the overall sample mean yield.</p>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb230-1"><a href="randomized-complete-block-design.html#cb230-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">contrasts=</span><span class="fu">c</span>(<span class="st">&#39;contr.sum&#39;</span>, <span class="st">&#39;contr.sum&#39;</span>))</span>
<span id="cb230-2"><a href="randomized-complete-block-design.html#cb230-2" aria-hidden="true" tabindex="-1"></a>my.lm.sum <span class="ot">&lt;-</span> <span class="fu">lm</span>(Yield<span class="sc">~</span>Process<span class="sc">+</span>Batch, <span class="at">data =</span> penicillin)</span>
<span id="cb230-3"><a href="randomized-complete-block-design.html#cb230-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(my.lm.sum)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Yield ~ Process + Batch, data = penicillin)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
##  -5.00  -2.25  -0.50   2.25   6.00 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  86.0000     0.9704  88.624  &lt; 2e-16 ***
## Process1     -2.0000     1.6808  -1.190  0.25708    
## Process2     -1.0000     1.6808  -0.595  0.56292    
## Process3      3.0000     1.6808   1.785  0.09956 .  
## Batch1        6.0000     1.9408   3.092  0.00934 ** 
## Batch2       -3.0000     1.9408  -1.546  0.14812    
## Batch3       -1.0000     1.9408  -0.515  0.61573    
## Batch4        2.0000     1.9408   1.031  0.32310    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 4.34 on 12 degrees of freedom
## Multiple R-squared:  0.5964, Adjusted R-squared:  0.361 
## F-statistic: 2.534 on 7 and 12 DF,  p-value: 0.07535</code></pre>
<p>We can obtain design matrices under both sets of constraints using the <em>model.matrix</em> function. Note that the sum-to-zero design matrix literally has columns summing to zero!</p>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb232-1"><a href="randomized-complete-block-design.html#cb232-1" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(my.lm)</span>
<span id="cb232-2"><a href="randomized-complete-block-design.html#cb232-2" aria-hidden="true" tabindex="-1"></a>X</span></code></pre></div>
<pre><code>##    (Intercept) ProcessB ProcessC ProcessD Batch2 Batch3 Batch4 Batch5
## 1            1        0        0        0      0      0      0      0
## 2            1        1        0        0      0      0      0      0
## 3            1        0        1        0      0      0      0      0
## 4            1        0        0        1      0      0      0      0
## 5            1        0        0        0      1      0      0      0
## 6            1        1        0        0      1      0      0      0
## 7            1        0        1        0      1      0      0      0
## 8            1        0        0        1      1      0      0      0
## 9            1        0        0        0      0      1      0      0
## 10           1        1        0        0      0      1      0      0
## 11           1        0        1        0      0      1      0      0
## 12           1        0        0        1      0      1      0      0
## 13           1        0        0        0      0      0      1      0
## 14           1        1        0        0      0      0      1      0
## 15           1        0        1        0      0      0      1      0
## 16           1        0        0        1      0      0      1      0
## 17           1        0        0        0      0      0      0      1
## 18           1        1        0        0      0      0      0      1
## 19           1        0        1        0      0      0      0      1
## 20           1        0        0        1      0      0      0      1
## attr(,&quot;assign&quot;)
## [1] 0 1 1 1 2 2 2 2
## attr(,&quot;contrasts&quot;)
## attr(,&quot;contrasts&quot;)$Process
## [1] &quot;contr.treatment&quot;
## 
## attr(,&quot;contrasts&quot;)$Batch
## [1] &quot;contr.treatment&quot;</code></pre>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb234-1"><a href="randomized-complete-block-design.html#cb234-1" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(my.lm.sum)</span>
<span id="cb234-2"><a href="randomized-complete-block-design.html#cb234-2" aria-hidden="true" tabindex="-1"></a>X</span></code></pre></div>
<pre><code>##    (Intercept) Process1 Process2 Process3 Batch1 Batch2 Batch3 Batch4
## 1            1        1        0        0      1      0      0      0
## 2            1        0        1        0      1      0      0      0
## 3            1        0        0        1      1      0      0      0
## 4            1       -1       -1       -1      1      0      0      0
## 5            1        1        0        0      0      1      0      0
## 6            1        0        1        0      0      1      0      0
## 7            1        0        0        1      0      1      0      0
## 8            1       -1       -1       -1      0      1      0      0
## 9            1        1        0        0      0      0      1      0
## 10           1        0        1        0      0      0      1      0
## 11           1        0        0        1      0      0      1      0
## 12           1       -1       -1       -1      0      0      1      0
## 13           1        1        0        0      0      0      0      1
## 14           1        0        1        0      0      0      0      1
## 15           1        0        0        1      0      0      0      1
## 16           1       -1       -1       -1      0      0      0      1
## 17           1        1        0        0     -1     -1     -1     -1
## 18           1        0        1        0     -1     -1     -1     -1
## 19           1        0        0        1     -1     -1     -1     -1
## 20           1       -1       -1       -1     -1     -1     -1     -1
## attr(,&quot;assign&quot;)
## [1] 0 1 1 1 2 2 2 2
## attr(,&quot;contrasts&quot;)
## attr(,&quot;contrasts&quot;)$Process
## [1] &quot;contr.sum&quot;
## 
## attr(,&quot;contrasts&quot;)$Batch
## [1] &quot;contr.sum&quot;</code></pre>
</div>
<div id="sums-of-squares-and-f-tests-in-rcbd" class="section level3 hasAnchor" number="7.2.3">
<h3><span class="header-section-number">7.2.3</span> Sums of squares and F tests in RCBD<a href="randomized-complete-block-design.html#sums-of-squares-and-f-tests-in-rcbd" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The primary goal of RCBD experiments is usually to evaluate whether all the treatment mean responses are equal, just as in one-way ANOVA. And, as in <em>completely randomized experiments</em> — experiments in which a random sample of experimental units are randomly assigned treatments — an F test based on the ratio of two variance estimators is useful for testing this hypothesis. Keep in mind that we are not interested in testing whether the block mean responses are all equal, although we will consider a measure of the usefulness of blocking later on.<br><br></p>
<p>Just as in the completely randomized design, for RCBD experiments we can decompose the total sum of squares into components for blocks, treatments, and the “errors”:</p>
<p><span class="math display">\[\begin{align*}
SST &amp; = SSE + SSBl + SSTr\\
SST &amp; = \sum_{i=1}^n\sum_{j=1}^J\sum_{k=1}^r (y_{ijk} - \overline y_{\cdot\cdot\cdot})^2\\
SSBl &amp; = (rJ)\sum_{i=1}^n (\overline y_{i\cdot\cdot} - \overline y_{\cdot\cdot\cdot})^2\\
SSTr &amp; = (rn)\sum_{j=1}^J (\overline y_{\cdot j\cdot} - \overline y_{\cdot\cdot\cdot})^2\\
SSE &amp; = \sum_{i=1}^n\sum_{j=1}^J\sum_{k=1}^r (y_{ijk} -\overline y_{i\cdot\cdot}-\overline y_{\cdot j\cdot} + \overline y_{\cdot\cdot\cdot})^2
\end{align*}\]</span></p>
<p>To test the hypothesis <span class="math inline">\(H_0:\tau_j = 0, \,j=1, \ldots, J\)</span>, or equivalently, that the treatments have no effect (the mean response is constant over treatments) versus <span class="math inline">\(H_a:\text{ not all treatment effects are 0 }\)</span>, i.e., <span class="math inline">\(H_a: \tau_j\ne 0, \text{ for some }j\in \{1, \ldots, J\}\)</span>, we use the following F statistic:
<span class="math display">\[F = \frac{SSTr/(J-1)}{SSE/(nJr - n - J +1)}\stackrel{H_0}{\sim} F_{J-1, nJr - n - J +1}.\]</span>
To compute degrees of freedom of a sum of squares, the general rule is to subtract from the total number of summands the number of estimated parameters. For example, in SSTr there are J summands and 1 “estimated parameter”, which is the parameter estimated by <span class="math inline">\(\overline y_{\cdot\cdot\cdot}\)</span>. And, in SSE there are <span class="math inline">\(nJr\)</span> summands, and there are <span class="math inline">\(n+J+1-2\)</span> uniquely determined sample means in the set <span class="math inline">\(\{\overline y_{1\cdot\cdot},\ldots, \overline y_{n\cdot\cdot}, \overline y_{\cdot 1\cdot}, \ldots, \overline y_{\cdot J\cdot},\overline y_{\cdot\cdot\cdot}\}\)</span> as discussed above.</p>
</div>
<div id="example-significance-of-process-in-penicillin-experiment" class="section level3 hasAnchor" number="7.2.4">
<h3><span class="header-section-number">7.2.4</span> Example: Significance of Process in Penicillin experiment<a href="randomized-complete-block-design.html#example-significance-of-process-in-penicillin-experiment" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The F test does not suggest mean yield varies over the four penicillin manufacturing processes.</p>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="randomized-complete-block-design.html#cb236-1" aria-hidden="true" tabindex="-1"></a>SST <span class="ot">&lt;-</span> <span class="fu">sum</span>((penicillin<span class="sc">$</span>Yield <span class="sc">-</span> <span class="fu">mean</span>(penicillin<span class="sc">$</span>Yield))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb236-2"><a href="randomized-complete-block-design.html#cb236-2" aria-hidden="true" tabindex="-1"></a>SSTr <span class="ot">&lt;-</span> <span class="dv">5</span><span class="sc">*</span><span class="fu">sum</span>((by_trt<span class="sc">$</span>trt_mean <span class="sc">-</span> <span class="fu">mean</span>(penicillin<span class="sc">$</span>Yield))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb236-3"><a href="randomized-complete-block-design.html#cb236-3" aria-hidden="true" tabindex="-1"></a>SSBl <span class="ot">&lt;-</span> <span class="dv">4</span><span class="sc">*</span><span class="fu">sum</span>((by_batch<span class="sc">$</span>batch_mean <span class="sc">-</span> <span class="fu">mean</span>(penicillin<span class="sc">$</span>Yield))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb236-4"><a href="randomized-complete-block-design.html#cb236-4" aria-hidden="true" tabindex="-1"></a>SSE <span class="ot">&lt;-</span> SST <span class="sc">-</span> SSTr <span class="sc">-</span> SSBl</span>
<span id="cb236-5"><a href="randomized-complete-block-design.html#cb236-5" aria-hidden="true" tabindex="-1"></a>SSTr</span></code></pre></div>
<pre><code>## [1] 70</code></pre>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="randomized-complete-block-design.html#cb238-1" aria-hidden="true" tabindex="-1"></a>SSBl</span></code></pre></div>
<pre><code>## [1] 264</code></pre>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="randomized-complete-block-design.html#cb240-1" aria-hidden="true" tabindex="-1"></a>SSE</span></code></pre></div>
<pre><code>## [1] 226</code></pre>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb242-1"><a href="randomized-complete-block-design.html#cb242-1" aria-hidden="true" tabindex="-1"></a>F <span class="ot">&lt;-</span> (SSTr<span class="sc">/</span>(<span class="dv">4-1</span>))<span class="sc">/</span>(SSE <span class="sc">/</span> (<span class="dv">5</span><span class="sc">*</span><span class="dv">4-4-5</span><span class="sc">+</span><span class="dv">1</span>))</span>
<span id="cb242-2"><a href="randomized-complete-block-design.html#cb242-2" aria-hidden="true" tabindex="-1"></a>F</span></code></pre></div>
<pre><code>## [1] 1.238938</code></pre>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="randomized-complete-block-design.html#cb244-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">-</span><span class="fu">pf</span>(F,<span class="dv">4-1</span>,<span class="dv">5</span><span class="sc">*</span><span class="dv">4-4-5</span><span class="sc">+</span><span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] 0.3386581</code></pre>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb246-1"><a href="randomized-complete-block-design.html#cb246-1" aria-hidden="true" tabindex="-1"></a>my.aov <span class="ot">&lt;-</span> <span class="fu">aov</span>(Yield<span class="sc">~</span>Batch<span class="sc">+</span>Process, penicillin)</span>
<span id="cb246-2"><a href="randomized-complete-block-design.html#cb246-2" aria-hidden="true" tabindex="-1"></a>my.aov</span></code></pre></div>
<pre><code>## Call:
##    aov(formula = Yield ~ Batch + Process, data = penicillin)
## 
## Terms:
##                 Batch Process Residuals
## Sum of Squares    264      70       226
## Deg. of Freedom     4       3        12
## 
## Residual standard error: 4.339739
## Estimated effects may be unbalanced</code></pre>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb248-1"><a href="randomized-complete-block-design.html#cb248-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(my.aov)</span></code></pre></div>
<pre><code>##             Df Sum Sq Mean Sq F value Pr(&gt;F)  
## Batch        4    264   66.00   3.504 0.0407 *
## Process      3     70   23.33   1.239 0.3387  
## Residuals   12    226   18.83                 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<div id="follow-up-comparisons-and-contrasts" class="section level3 hasAnchor" number="7.2.5">
<h3><span class="header-section-number">7.2.5</span> Follow-up comparisons and contrasts<a href="randomized-complete-block-design.html#follow-up-comparisons-and-contrasts" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Just as in one-way ANOVA for a completely randomized design (CRD) we may analyze pairwise comparisons of treatment mean responses when the F test rejects the hypothesis that all treatment means are the same. Or, we could estimate and test planned contrasts. And, there is essentially no differnce in how we apply these estimates and tests compared with CRD.
<br><br></p>
<p>To compute Tukey HSD confidence intervals we use essentially the same formula:
<span class="math display">\[\left(\overline Y_{i\cdot \cdot} - \overline Y_{\ell \cdot \cdot} \pm 2^{-1/2}q_{1-\alpha, \,J, \,nJr - n- J +1}\sqrt{MSE\left(\frac{1}{rn} + \frac{1}{rn}\right)}\right)\]</span>
to define a set of simultaneous <span class="math inline">\(100(1-\alpha)\%\)</span> CIs for the pairwise differences of treatment mean responses. (Recall <span class="math inline">\(q_{\alpha, \,u, \,v}\)</span> is the <span class="math inline">\(\alpha\)</span> quantile of Tukey’s Studentized range distribution for <span class="math inline">\(u\)</span> means and with <span class="math inline">\(v\)</span> df.)
<br><br></p>
<p>Let <span class="math inline">\(\gamma = c^\top \mu = \sum_{i=1}^J c_i \mu_i\)</span> denote a linear combination of treatment mean responses where <span class="math inline">\(\sum_{i=1}^J c_i = 0\)</span>. Then, <span class="math inline">\(\gamma\)</span> is a contrast, and
<span class="math display">\[t = \frac{\hat\gamma - \gamma}{\sqrt{MSE\sum_{i=1}^J \left(\frac{c_i^2}{nr}\right)}}\sim t_{nrJ - n-J+1},\]</span>
where <span class="math inline">\(\hat\gamma = \sum_{i=1}^J c_i \overline Y_{i\cdot\cdot}\)</span>. This <span class="math inline">\(t\)</span> random variable may be used to derive point null hypothesis tests and CIs for <span class="math inline">\(\gamma\)</span>.<br><br></p>
<p>For simultaneous tests or CIs for a set of contrasts, we may use Scheff'e’s method. The Scheff'e simultaneous <span class="math inline">\(100(1-\alpha)\%\)</span> CIs for all linear contrasts are given by:
<span class="math display">\[\left(\hat\gamma \pm \sqrt{(J-1)F_{1-\alpha, J-1, nJr-n-J+1}}\sqrt{MSE\sum_{i=1}^J \left(\frac{c_i^2}{nr}\right)}\right).\]</span></p>
</div>
<div id="example-tukey-contrasts-and-scheffe-for-penicillin-experiment" class="section level3 hasAnchor" number="7.2.6">
<h3><span class="header-section-number">7.2.6</span> Example: Tukey, contrasts, and Scheffe for penicillin experiment<a href="randomized-complete-block-design.html#example-tukey-contrasts-and-scheffe-for-penicillin-experiment" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>There is no reason to use Tukey’s method with the penicillin experiment given the F test supports the null hypothesis. But, just for practice we can compute the Process B - Process A CI and compare with the built-in TukeyHSD function.</p>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb250-1"><a href="randomized-complete-block-design.html#cb250-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(by_trt<span class="sc">$</span>trt_mean[<span class="dv">2</span>] <span class="sc">-</span> by_trt<span class="sc">$</span>trt_mean[<span class="dv">1</span>] <span class="sc">-</span> <span class="fu">sqrt</span>(.<span class="dv">5</span>)<span class="sc">*</span><span class="fu">qtukey</span>(<span class="fl">0.95</span>, <span class="dv">4</span>, <span class="dv">4</span><span class="sc">*</span><span class="dv">5-4-5</span><span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span><span class="fu">sqrt</span>((SSE <span class="sc">/</span> (<span class="dv">5</span><span class="sc">*</span><span class="dv">4-4-5</span><span class="sc">+</span><span class="dv">1</span>))<span class="sc">*</span>(<span class="dv">2</span><span class="sc">/</span><span class="dv">5</span>)),</span>
<span id="cb250-2"><a href="randomized-complete-block-design.html#cb250-2" aria-hidden="true" tabindex="-1"></a>by_trt<span class="sc">$</span>trt_mean[<span class="dv">2</span>] <span class="sc">-</span> by_trt<span class="sc">$</span>trt_mean[<span class="dv">1</span>] <span class="sc">+</span> <span class="fu">sqrt</span>(.<span class="dv">5</span>)<span class="sc">*</span><span class="fu">qtukey</span>(<span class="fl">0.95</span>, <span class="dv">4</span>, <span class="dv">4</span><span class="sc">*</span><span class="dv">5-4-5</span><span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span><span class="fu">sqrt</span>((SSE <span class="sc">/</span> (<span class="dv">5</span><span class="sc">*</span><span class="dv">4-4-5</span><span class="sc">+</span><span class="dv">1</span>))<span class="sc">*</span>(<span class="dv">2</span><span class="sc">/</span><span class="dv">5</span>)))</span></code></pre></div>
<pre><code>## [1] -7.148719  9.148719</code></pre>
<div class="sourceCode" id="cb252"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb252-1"><a href="randomized-complete-block-design.html#cb252-1" aria-hidden="true" tabindex="-1"></a><span class="fu">TukeyHSD</span>(my.aov, <span class="at">which =</span> <span class="st">&#39;Process&#39;</span>)</span></code></pre></div>
<pre><code>##   Tukey multiple comparisons of means
##     95% family-wise confidence level
## 
## Fit: aov(formula = Yield ~ Batch + Process, data = penicillin)
## 
## $Process
##     diff        lwr       upr     p adj
## B-A    1  -7.148719  9.148719 0.9826684
## C-A    5  -3.148719 13.148719 0.3105094
## D-A    2  -6.148719 10.148719 0.8837551
## C-B    4  -4.148719 12.148719 0.4905194
## D-B    1  -7.148719  9.148719 0.9826684
## D-C   -3 -11.148719  5.148719 0.7002271</code></pre>
<p>Next, let’s test is the Process C mean yield is different than the average of the other processes. This is a contrast with <span class="math inline">\(c = (-1/3,-1/3,1,-1/3)\)</span>. We might be tempted to test this particular contrast after peeking at the boxplot above. That’s not a good idea! Using the data to suggest tests to perform leads to inflated Type 1 errors. However, if we apply Scheff'e’s correction, then we control the Type 1 error rate for all linear contrasts, which includes comparisons that are <em>inspired</em> by the data. <br><br></p>
<p>At <span class="math inline">\(\alpha = .10\)</span> we would actually reject the null hypothesis that the Process C mean is equal to the average of the A, B, and D means if we performed the uncorrected test (which we should not because we chose to based on the boxplot). But, the Scheff'e correction saves us from our shameful p-value snooping!</p>
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb254-1"><a href="randomized-complete-block-design.html#cb254-1" aria-hidden="true" tabindex="-1"></a>hat.gamma <span class="ot">&lt;-</span> by_trt<span class="sc">$</span>trt_mean[<span class="dv">3</span>] <span class="sc">-</span> <span class="fu">mean</span>(<span class="fu">c</span>(by_trt<span class="sc">$</span>trt_mean[<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>)]))</span>
<span id="cb254-2"><a href="randomized-complete-block-design.html#cb254-2" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> hat.gamma <span class="sc">/</span> <span class="fu">sqrt</span>((SSE <span class="sc">/</span> (<span class="dv">5</span><span class="sc">*</span><span class="dv">4-4-5</span><span class="sc">+</span><span class="dv">1</span>)) <span class="sc">*</span> (<span class="dv">1</span><span class="sc">/</span><span class="dv">5</span> <span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">/</span>(<span class="dv">5</span><span class="sc">*</span><span class="dv">9</span>))))</span>
<span id="cb254-3"><a href="randomized-complete-block-design.html#cb254-3" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">pt</span>(<span class="fu">abs</span>(t), <span class="dv">5</span><span class="sc">*</span><span class="dv">4-4-5</span><span class="sc">+</span><span class="dv">1</span>)) <span class="co"># uncorrected p-value</span></span></code></pre></div>
<pre><code>## [1] 0.09955857</code></pre>
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb256-1"><a href="randomized-complete-block-design.html#cb256-1" aria-hidden="true" tabindex="-1"></a>F <span class="ot">&lt;-</span> (t<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">4-1</span>))<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb256-2"><a href="randomized-complete-block-design.html#cb256-2" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">-</span><span class="fu">pf</span>(F, <span class="dv">4-1</span>, <span class="dv">5</span><span class="sc">*</span><span class="dv">4-4-5</span><span class="sc">+</span><span class="dv">1</span>) <span class="co"># Scheffe corrected p-value</span></span></code></pre></div>
<pre><code>## [1] 0.4014427</code></pre>
<div class="sourceCode" id="cb258"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb258-1"><a href="randomized-complete-block-design.html#cb258-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emmeans) </span>
<span id="cb258-2"><a href="randomized-complete-block-design.html#cb258-2" aria-hidden="true" tabindex="-1"></a>fit.emm <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(my.aov, <span class="st">&quot;Process&quot;</span>)</span>
<span id="cb258-3"><a href="randomized-complete-block-design.html#cb258-3" aria-hidden="true" tabindex="-1"></a><span class="co"># unadjusted, just testing one contrast</span></span>
<span id="cb258-4"><a href="randomized-complete-block-design.html#cb258-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">contrast</span>(fit.emm, <span class="at">method =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="sc">-</span><span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>))))</span></code></pre></div>
<pre><code>##  contrast                                                        estimate   SE
##  c(-0.333333333333333, -0.333333333333333, 1, -0.333333333333333        4 2.24
##  df t.ratio p.value
##  12   1.785  0.0996
## 
## Results are averaged over the levels of: Batch</code></pre>
<div class="sourceCode" id="cb260"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb260-1"><a href="randomized-complete-block-design.html#cb260-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Scheffe adjustment so that we could test all linear contrasts</span></span>
<span id="cb260-2"><a href="randomized-complete-block-design.html#cb260-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">contrast</span>(fit.emm, <span class="at">method =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="sc">-</span><span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>)), </span>
<span id="cb260-3"><a href="randomized-complete-block-design.html#cb260-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">adjust =</span> <span class="st">&quot;scheffe&quot;</span>), <span class="at">scheffe.rank =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>##  contrast                                                        estimate   SE
##  c(-0.333333333333333, -0.333333333333333, 1, -0.333333333333333        4 2.24
##  df t.ratio p.value
##  12   1.785  0.4014
## 
## Results are averaged over the levels of: Batch 
## P value adjustment: scheffe method with rank 3</code></pre>
</div>
<div id="relative-efficiency-of-blocking-vs.-crd" class="section level3 hasAnchor" number="7.2.7">
<h3><span class="header-section-number">7.2.7</span> Relative efficiency of Blocking (vs. CRD)<a href="randomized-complete-block-design.html#relative-efficiency-of-blocking-vs.-crd" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>After an RCBD experiment is performed it is sometimes helpful for researchers to understand whether blocking was a helpful part of the experimental design. Blocking variables are selected by the researchers with the belief their levels are associated with different average responses. The idea is that if we take into account the variability in response due to block variable levels, we will reduce the unexplained variability. This manifests in the decomposition
<span class="math display">\[SST = SSE + SSBl + SSTr\]</span>
where we expect the block sum of squares to “absorb” part of the SSE that would have been present in a CRD. Smaller SSE in turn increases the F statistic <span class="math inline">\(F = MSTr/MSE\)</span> for testing significance of the treatments by lowering the denominator in the ratio. On the other hand, blocking creates an opposite effect that decreases this F statistic as well. Just like the total sum of squares decomposes, so do the degrees of freedom:
<span class="math display">\[nJr - 1 = (nJr - n - J + 1) + (n-1) + (J-1).\]</span>
The upshot is that the number of degrees of freedom “used” in estimating SSE is smaller if blocks are included compared to a CRD with no blocks and equal total sample size. This reduces the denominator of MSE, which increases MSE relative to CRD and thus decreases the F ratio for testing for significant treatment effects. Usually, if experimenters choose a small number of intuitively useful blocks, RCBD is “more efficient” than CRD in the sense that its F test has increased power to detect treatment effects.<br><br></p>
<p>We can attempt to quantify the effect of blocking compared to CRD using a post-experiment measure called the relative efficiency (RE) of blocking (relative, that is, to CRD). The formula, given below, accounts for both the decrease in degrees of freedom and the approximate decrease in <span class="math inline">\(\hat\sigma^2\)</span> when blocking (RCBD) versus not blocking (CRD):
<span class="math display">\[RE = \frac{df_{MSE,RCBD} + 1}{df_{MSE,CRD} + 1}\frac{df_{MSE,CRD} + 3}{df_{MSE,RCBD} + 3}\frac{\hat\sigma^2_{CRD}}{\hat\sigma^2_{RCBD}},\]</span>
where
<span class="math display">\[\hat\sigma^2_{CRD} = MSE_{CRD},\]</span>
<span class="math display">\[MSE_{CRD} = \frac{df_{Bl}MSBl_{RCBD} + (df_{Tr}+df_{E})MSE_{RCBD}}{df_{Bl} + df_{Tr} + df_E}.\]</span>
And, from above, we have
<span class="math display">\[df_{Tr} = J-1, \quad df_{Bl} = n-1, \quad df_{E} = df_{MSE,RCBD} = nJr - n - J +1, \quad \text{and    }\, df_{MSE,CRD} = nJr - J.\]</span></p>
</div>
<div id="example-re-of-blocking-in-penicillin-experiment" class="section level3 hasAnchor" number="7.2.8">
<h3><span class="header-section-number">7.2.8</span> Example: RE of blocking in penicillin experiment<a href="randomized-complete-block-design.html#example-re-of-blocking-in-penicillin-experiment" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The relative efficiency of blocking is about 1.48, which can be interpreted as saying each replicated response in the RCBD experiment provides approximately 1.48 times at much (<span class="math inline">\(48\%\)</span> more) information compared to a replicate in a CRD design. In other words, it would take <span class="math inline">\(48\%\)</span> more samples in a CRD to get the same amount of information as in a RCBD. As long as RE is above 1, the RCBD design provides an advantage over CRD. Since it may be substantially more work to implement a RCBD than a CRD, experimenters would like to see a substantial advantage in RE for RCBD relative to CRD.</p>
<div class="sourceCode" id="cb262"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb262-1"><a href="randomized-complete-block-design.html#cb262-1" aria-hidden="true" tabindex="-1"></a>MSE_RCBD <span class="ot">&lt;-</span> SSE <span class="sc">/</span> (<span class="dv">4</span><span class="sc">*</span><span class="dv">5-4-5</span><span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb262-2"><a href="randomized-complete-block-design.html#cb262-2" aria-hidden="true" tabindex="-1"></a>MSBl <span class="ot">&lt;-</span> SSBl <span class="sc">/</span> (<span class="dv">5-1</span>)</span>
<span id="cb262-3"><a href="randomized-complete-block-design.html#cb262-3" aria-hidden="true" tabindex="-1"></a>MSE_CRD <span class="ot">&lt;-</span> ((<span class="dv">5-1</span>)<span class="sc">*</span>MSBl <span class="sc">+</span> (<span class="dv">5</span><span class="sc">*</span><span class="dv">4-5-4</span><span class="sc">+</span><span class="dv">1</span> <span class="sc">+</span> <span class="dv">4-1</span>)<span class="sc">*</span>MSE_RCBD)<span class="sc">/</span>(<span class="dv">5</span><span class="sc">*</span><span class="dv">4-5-4</span><span class="sc">+</span><span class="dv">1</span><span class="sc">+</span><span class="dv">4-1</span><span class="sc">+</span><span class="dv">5-1</span>)</span>
<span id="cb262-4"><a href="randomized-complete-block-design.html#cb262-4" aria-hidden="true" tabindex="-1"></a>df_MSE_CRD <span class="ot">&lt;-</span> <span class="dv">5</span><span class="sc">*</span><span class="dv">4-4</span></span>
<span id="cb262-5"><a href="randomized-complete-block-design.html#cb262-5" aria-hidden="true" tabindex="-1"></a>df_MSE_RCBD <span class="ot">&lt;-</span> <span class="dv">5</span><span class="sc">*</span><span class="dv">4-4-5</span><span class="sc">+</span><span class="dv">1</span></span>
<span id="cb262-6"><a href="randomized-complete-block-design.html#cb262-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb262-7"><a href="randomized-complete-block-design.html#cb262-7" aria-hidden="true" tabindex="-1"></a>RE <span class="ot">&lt;-</span> (MSE_CRD<span class="sc">/</span>MSE_RCBD) <span class="sc">*</span> ((df_MSE_CRD<span class="sc">+</span><span class="dv">3</span>)<span class="sc">/</span>(df_MSE_RCBD <span class="sc">+</span><span class="dv">3</span>)) <span class="sc">*</span> ((df_MSE_RCBD<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span>(df_MSE_CRD <span class="sc">+</span><span class="dv">1</span>))</span>
<span id="cb262-8"><a href="randomized-complete-block-design.html#cb262-8" aria-hidden="true" tabindex="-1"></a>RE</span></code></pre></div>
<pre><code>## [1] 1.479334</code></pre>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="one-way-anova.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="latin-squares-for-two-blocking-variables.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/06-RCBD.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
