<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Tests Based on a univariate Random Sample | Applied Linear Models</title>
  <meta name="description" content="These are a collection of notes related to STAT 500 at Iowa State University. This is a work in progress." />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Tests Based on a univariate Random Sample | Applied Linear Models" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="These are a collection of notes related to STAT 500 at Iowa State University. This is a work in progress." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Tests Based on a univariate Random Sample | Applied Linear Models" />
  
  <meta name="twitter:description" content="These are a collection of notes related to STAT 500 at Iowa State University. This is a work in progress." />
  

<meta name="author" content="Nick Syring" />


<meta name="date" content="2022-08-10" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="data-analysis-and-statistical-inference.html"/>
<link rel="next" href="blocks.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>




<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Applied Linear Models</a></li>

<li class="divider"></li>
<li><a href="index.html#about" id="toc-about"><span class="toc-section-number">1</span> About</a></li>
<li><a href="data-analysis-and-statistical-inference.html#data-analysis-and-statistical-inference" id="toc-data-analysis-and-statistical-inference"><span class="toc-section-number">2</span> Data Analysis and Statistical Inference</a>
<ul>
<li><a href="data-analysis-and-statistical-inference.html#data-experiments-and-studies" id="toc-data-experiments-and-studies"><span class="toc-section-number">2.1</span> Data, Experiments, and Studies</a>
<ul>
<li><a href="data-analysis-and-statistical-inference.html#james-linds-scurvy-trial" id="toc-james-linds-scurvy-trial"><span class="toc-section-number">2.1.1</span> James Lind’s Scurvy Trial</a></li>
<li><a href="data-analysis-and-statistical-inference.html#framingham-heart-study" id="toc-framingham-heart-study"><span class="toc-section-number">2.1.2</span> Framingham Heart Study</a></li>
<li><a href="data-analysis-and-statistical-inference.html#harris-bank-sex-pay-study" id="toc-harris-bank-sex-pay-study"><span class="toc-section-number">2.1.3</span> Harris Bank Sex Pay Study</a></li>
<li><a href="data-analysis-and-statistical-inference.html#large-aggregated-data-sets" id="toc-large-aggregated-data-sets"><span class="toc-section-number">2.1.4</span> Large, Aggregated Data Sets</a></li>
<li><a href="data-analysis-and-statistical-inference.html#study-concepts" id="toc-study-concepts"><span class="toc-section-number">2.1.5</span> Study Concepts</a></li>
<li><a href="data-analysis-and-statistical-inference.html#randomization-control-and-causation" id="toc-randomization-control-and-causation"><span class="toc-section-number">2.1.6</span> Randomization, control, and causation</a></li>
<li><a href="data-analysis-and-statistical-inference.html#populations-and-scope-of-inference" id="toc-populations-and-scope-of-inference"><span class="toc-section-number">2.1.7</span> Populations and scope of inference</a></li>
</ul></li>
<li><a href="data-analysis-and-statistical-inference.html#data-summaries" id="toc-data-summaries"><span class="toc-section-number">2.2</span> Data Summaries</a>
<ul>
<li><a href="data-analysis-and-statistical-inference.html#numerical-summaries" id="toc-numerical-summaries"><span class="toc-section-number">2.2.1</span> Numerical Summaries</a></li>
<li><a href="data-analysis-and-statistical-inference.html#visual-summaries" id="toc-visual-summaries"><span class="toc-section-number">2.2.2</span> Visual Summaries</a></li>
</ul></li>
<li><a href="data-analysis-and-statistical-inference.html#statistical-inference" id="toc-statistical-inference"><span class="toc-section-number">2.3</span> Statistical Inference</a></li>
</ul></li>
<li><a href="tests-based-on-a-univariate-random-sample.html#tests-based-on-a-univariate-random-sample" id="toc-tests-based-on-a-univariate-random-sample"><span class="toc-section-number">3</span> Tests Based on a univariate Random Sample</a>
<ul>
<li><a href="tests-based-on-a-univariate-random-sample.html#pivotal-inference" id="toc-pivotal-inference"><span class="toc-section-number">3.1</span> Pivotal Inference</a></li>
<li><a href="tests-based-on-a-univariate-random-sample.html#approximate-pivots" id="toc-approximate-pivots"><span class="toc-section-number">3.2</span> Approximate Pivots</a></li>
<li><a href="tests-based-on-a-univariate-random-sample.html#asymptotic-pivots-and-likelihood-based-tests" id="toc-asymptotic-pivots-and-likelihood-based-tests"><span class="toc-section-number">3.3</span> Asymptotic Pivots and Likelihood-based Tests</a></li>
<li><a href="tests-based-on-a-univariate-random-sample.html#bootstrap-based-tests" id="toc-bootstrap-based-tests"><span class="toc-section-number">3.4</span> Bootstrap-based Tests</a></li>
<li><a href="tests-based-on-a-univariate-random-sample.html#randomization-tests" id="toc-randomization-tests"><span class="toc-section-number">3.5</span> Randomization Tests</a></li>
<li><a href="tests-based-on-a-univariate-random-sample.html#exercises" id="toc-exercises"><span class="toc-section-number">3.6</span> Exercises</a></li>
</ul></li>
<li><a href="blocks.html#blocks" id="toc-blocks"><span class="toc-section-number">4</span> Blocks</a>
<ul>
<li><a href="blocks.html#equations" id="toc-equations"><span class="toc-section-number">4.1</span> Equations</a></li>
<li><a href="blocks.html#theorems-and-proofs" id="toc-theorems-and-proofs"><span class="toc-section-number">4.2</span> Theorems and proofs</a></li>
<li><a href="blocks.html#callout-blocks" id="toc-callout-blocks"><span class="toc-section-number">4.3</span> Callout blocks</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Applied Linear Models</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="tests-based-on-a-univariate-random-sample" class="section level1" number="3">
<h1><span class="header-section-number">Chapter 3</span> Tests Based on a univariate Random Sample</h1>
<p>In this section we briefly review methods for constructing tests about hypothesis tests. To keep things fairly simple, consider measuring one variable and suppose we obtain a simple random sample of such measurements/observations, denoted <span class="math inline">\(x_1, \ldots, x_n\)</span>. We’ll refer to the random variable versions (yet to be observed versions) of such observations by <span class="math inline">\(X_1, \ldots, X_n\)</span>, per usual.</p>
<p>First we discuss the pivotal method for statistical inference, including approximate and asymptotic pivots. Next we’ll briefly describe the bootstrap method, which, unlike the pivotal method, does not require a full sampling model of the data. Finally, we consider so-called “randomization tests” which are not exactly hypothesis tests, but provide a means for assessing whether interventions or observed differences are associated with significant response differences in both experiments and observational studies.</p>
<p>In terms of setup, suppose <span class="math inline">\(X^n := (X_1, \ldots, X_n)\)</span> is a random sample of size <span class="math inline">\(n\)</span> from a population equivalent to a probability distribution <span class="math inline">\(P\)</span>, and that we are interested in making inferences about a parameter <span class="math inline">\(\theta = \theta(P)\)</span>, a functional of <span class="math inline">\(P\)</span>. We’ll consider special cases below. Also, for now we will consider only a “point null” hypothesis, <span class="math inline">\(H_0: \theta = \theta_0\)</span> versus <span class="math inline">\(H_a:\theta \ne \theta_0\)</span> where <span class="math inline">\(\theta_0\)</span> is a singleton.</p>
<div id="pivotal-inference" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Pivotal Inference</h2>
<p>Suppose <span class="math inline">\(H_0:\theta = \theta_0\)</span>. A pivot with respect to <span class="math inline">\(H_0\)</span> is a function, say, <span class="math inline">\(g\)</span>, of data and parameter with a distribution <span class="math inline">\(F\)</span> under <span class="math inline">\(H_0\)</span> depending on no unknown parameters. We can write this relationship as
<span class="math display">\[g(X_1, \ldots, X_n;\theta_0)\stackrel{H_0}\sim F.\]</span></p>
<p>You are likely familiar with several examples of pivots. If <span class="math inline">\(X^n\)</span> is a random sample from a normal distribution with mean <span class="math inline">\(\mu\)</span> and variance <span class="math inline">\(\sigma^2\)</span>, i.e., <span class="math inline">\(X_i\stackrel{iid}{\sim}N(\mu, \sigma^2), \,i=1,\ldots, n\)</span>, then
<span class="math display">\[g(X^n;\mu):=\frac{\overline X - \mu}{\sqrt{S^2/n}}\stackrel{d}{=}t_{n-1}\]</span>
where <span class="math inline">\(S^2\)</span> is the sample variance of <span class="math inline">\(X^n\)</span> and <span class="math inline">\(t_{n-1}\)</span> is a Student’s <span class="math inline">\(t\)</span> random variable with <span class="math inline">\(n-1\)</span> degrees of freedom.</p>
<p>A pivot for a point-null hypothesis admits a level-<span class="math inline">\(\alpha\)</span> test by the following general rule:
<span class="math display">\[\text{Reject }H_0\text{ if }g(x^n;\theta_0)\notin(U_{\alpha/2}, \, U_{1-\alpha/2})\]</span>
where <span class="math inline">\(U\sim F\)</span> and <span class="math inline">\(U_\alpha\)</span> denotes the <span class="math inline">\(\alpha\)</span> quantile of <span class="math inline">\(U\)</span>. The logic is as follows: if <span class="math inline">\(g(x^n;\theta_0)\notin(U_{\alpha/2}, \, U_{1-\alpha/2})\)</span> then either <span class="math inline">\(g(x^n;\theta_0)\)</span> is an unlikely realization of <span class="math inline">\(g(X^n;\theta_0)\)</span> or <span class="math inline">\(H_0\)</span> is false. Concluding <span class="math inline">\(H_0\)</span> false in such an event is erroneous with probability
<span class="math display">\[P_{H_0}(g(X^n;\theta_0)\leq U_{\alpha/2}) + P_{H_0}(g(X^n;\theta_0)\geq U_{1-\alpha/2}) = \alpha/2 + \alpha/2 = \alpha\]</span>
by design. In the case of the normal random sample and point-null regarding <span class="math inline">\(\mu\)</span> the general rule gives way to the <em>one-sample t-test</em>
<span class="math display">\[\text{Reject }H_0\text{ if }\frac{\overline X - \mu}{\sqrt{S^2/n}}\notin(t_{n-1, \alpha/2}, \, t_{n-1, 1-\alpha/2})\]</span></p>
<p>Pivot-based tests for point nulls have a one-to-one correspondence with <em>confidence intervals</em>. Given data <span class="math inline">\(X^n = x^n\)</span> define the confidence set <span class="math inline">\(C_{\alpha}(x^n):=\{\theta: g(x^n;\theta)\in(U_{\alpha/2}, \, U_{1-\alpha/2})\}\)</span>. The <em>coverage probability</em> of <span class="math inline">\(C_\alpha(x^n)\)</span> is equal to
<span class="math display">\[P_{\theta_0}(\theta_0 \in C_\alpha(X^n))\]</span>
where <span class="math inline">\(\theta_0\)</span> is the true parameter value, i.e., in a point-null hypothesis test it is the null value and <span class="math inline">\(P_{\theta_0}\)</span> means the same as <span class="math inline">\(P_{H_0}\)</span>.<br />
<span class="math display">\[\begin{align*}
P_{\theta_0}(\theta_0 \in C_\alpha(X^n)) &amp;= 1-P_{\theta_0}(\theta_0 \notin C_\alpha(X^n))\\
&amp; = P_{\theta_0}(g(X^n;\theta_0)\notin(U_{\alpha/2}, \, U_{1-\alpha/2}))\\
&amp; = 1-\alpha.
\end{align*}\]</span>
Therefore, the confidence set given above (which is usually an interval) has the <em>confidence property</em>
<span class="math display">\[P_{\theta_0}(\theta_0 \in C_\alpha(X^n))\geq 1-\alpha.\]</span>
Therefore, level-<span class="math inline">\(\alpha\)</span> tests of point null hypotheses enjoy a one-to-one correspondence with valid/exact confidence sets (these being adjectives to describe sets with the confidence property).</p>
</div>
<div id="approximate-pivots" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Approximate Pivots</h2>
</div>
<div id="asymptotic-pivots-and-likelihood-based-tests" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Asymptotic Pivots and Likelihood-based Tests</h2>
</div>
<div id="bootstrap-based-tests" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Bootstrap-based Tests</h2>
</div>
<div id="randomization-tests" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Randomization Tests</h2>
</div>
<div id="exercises" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Exercises</h2>
<ol style="list-style-type: decimal">
<li>You likely recall pivot-based tests for point-null hypotheses concerning <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma^2\)</span> in the context of a normal random sample. But, what about for a different parameter? Let <span class="math inline">\(\eta:=\mu/\sigma\)</span> denote the <em>signal-to-noise ratio</em>. Suppose we want to test <span class="math inline">\(H_0:\eta = \eta_0\)</span>. You probably can’t think of an obvious pivot for such a quantity. Towards deriving a level-<span class="math inline">\(\alpha\)</span> test for <span class="math inline">\(H_0\)</span> write down the following <em>data-generating equations</em> in terms of the sufficient statistics <span class="math inline">\((\overline X, S^2)\)</span>:
<span class="math display">\[\begin{align*}
\overline X &amp;= \mu + n^{-1/2}\sigma Z, \quad Z\sim N(0,1)\\
(n-1)S^2 &amp;= \sigma^2 V, \quad V\sim \chi^2(n-1), \quad V\perp Z.
\end{align*}\]</span>
Make the one-to-one transformation <span class="math inline">\((\mu, \sigma^2)\mapsto(\eta, \sigma^2)\)</span> and re-write the equations equivalently in terms of the new parametrization:
<span class="math display">\[\begin{align*}
\overline X &amp;= \sigma \eta + n^{-1/2}\sigma Z, \quad Z\sim N(0,1)\\
(n-1)S^2 &amp;= \sigma^2 V, \quad V\sim \chi^2(n-1), \quad V\perp Z.
\end{align*}\]</span>
Into the first equation, plug in <span class="math inline">\(\sigma = \sqrt{(n-1)S^2/V}\)</span> to arrive at
<span class="math display">\[\begin{align*}
\overline X &amp;= \eta\sqrt{(n-1)S^2/V} + n^{-1/2}\sqrt{(n-1)S^2/V} Z, \quad Z\sim N(0,1)\\
(n-1)S^2 &amp;= \sigma^2 V, \quad V\sim \chi^2(n-1), \quad V\perp Z.
\end{align*}\]</span>
Now, make the following observation, keeping in mind we are only interested in <span class="math inline">\(\eta\)</span>, not <span class="math inline">\(\sigma^2\)</span>. Fix any values of <span class="math inline">\((\overline X, \eta, S^2, V, Z)\)</span> such that the first equation is satisfied. It follows that there exists a value of <span class="math inline">\(\sigma^2&gt;0\)</span> simultaneously satisfying the second equation. Therefore, we can ignore the second equation. This is similar to what happens in the case of the one-sample t-test where we find a pivot not depending on <span class="math inline">\(\sigma^2\)</span>. Divide by <span class="math inline">\(\sqrt{S^2}\)</span> on both sides of the first equation: we are left with the following:
<span class="math display">\[\frac{\overline X}{\sqrt{S^2}} = \sqrt{(n-1)/V}\left (\eta + n^{-1/2}Z\right), \quad Z\sim N(0,1)\quad V\sim \chi^2(n-1), \quad V\perp Z.\]</span>
If you stare at this equation long enough, you will convince yourself you cannot solve for a pivot. Nevertheless, we have something similar, namely, a single equation involving the parameter of interest, the sufficient statistics, and random variables with known distributions. Define the following function:
<span class="math display">\[\pi(\eta) = 1-\left|2P_{Z,V}\left(\frac{\overline x}{\sqrt{s^2}} \leq \sqrt{(n-1)/V}\left (\eta + n^{-1/2}Z\right)\right) - 1\right|.\]</span>
Claim: the test that rejects <span class="math inline">\(H_0:\eta= \eta_0\)</span> when <span class="math inline">\(\pi(\eta_0) &lt;\alpha\)</span> is a level-alpha test. Similarly, the set <span class="math inline">\(\{\eta: \pi(\eta) &gt; \alpha\}\)</span> is a valid <span class="math inline">\((1-\alpha)\)</span> confidence set.</li>
</ol>
<p><br><br></p>
<p>Do either one the following:<br>
- Implement a Monte Carlo simulation to verify the claim.
- Verify the claim analytically.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="data-analysis-and-statistical-inference.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="blocks.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/02-Tests_based_on_One_Random_Sample.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
